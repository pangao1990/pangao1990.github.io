<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://pangao1990.gitee.io/images/favicon.jpg"><link rel="icon" href="https://pangao1990.gitee.io/images/favicon.jpg"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="潘高"><meta name="keywords" content="Python,Vue,JS,CSS,H5,HTML,Android,iOS,Java,Swift,Perl,微信小程序,开发,博客,潘高"><meta name="description" content="前言在 Python 中，访问网络资源最有名的库就是 requests、aiohttp 和 httpx。一般情况下，requests 只能发送同步请求；aiohttp 只能发送异步请求；httpx 既能发送同步请求，又能发送异步请求。 下面，就着重介绍一下 httpx 的使用方法。 安装使用 pip 安装 httpx： 1pip install httpx  当然了，httpx 也可以使用命令行操"><meta property="og:type" content="article"><meta property="og:title" content="Python3的下一代HTTP客户端——HTTPX"><meta property="og:url" content="https://blog.pangao.vip/Python3%E7%9A%84%E4%B8%8B%E4%B8%80%E4%BB%A3HTTP%E5%AE%A2%E6%88%B7%E7%AB%AF%E2%80%94%E2%80%94HTTPX/"><meta property="og:site_name" content="潘高的小站"><meta property="og:description" content="前言在 Python 中，访问网络资源最有名的库就是 requests、aiohttp 和 httpx。一般情况下，requests 只能发送同步请求；aiohttp 只能发送异步请求；httpx 既能发送同步请求，又能发送异步请求。 下面，就着重介绍一下 httpx 的使用方法。 安装使用 pip 安装 httpx： 1pip install httpx  当然了，httpx 也可以使用命令行操"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pangao1990.gitee.io/pic/index/Python3%E7%9A%84%E4%B8%8B%E4%B8%80%E4%BB%A3HTTP%E5%AE%A2%E6%88%B7%E7%AB%AF%E2%80%94%E2%80%94HTTPX.png"><meta property="article:published_time" content="2023-04-18T10:00:00.000Z"><meta property="article:modified_time" content="2023-04-18T05:45:01.580Z"><meta property="article:author" content="潘高"><meta property="article:tag" content="Python"><meta property="article:tag" content="HTTPX"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://pangao1990.gitee.io/pic/index/Python3%E7%9A%84%E4%B8%8B%E4%B8%80%E4%BB%A3HTTP%E5%AE%A2%E6%88%B7%E7%AB%AF%E2%80%94%E2%80%94HTTPX.png"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5317369003185250" crossorigin="anonymous"></script><meta name="google-site-verification" content="google180fd90b1a12c24d.html"><title>Python3的下一代HTTP客户端——HTTPX - 潘高的小站</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"blog.pangao.vip",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!1},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"3cb997f9d46af905b450452a8f181d9e",google:"UA-163962674-1",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:1278827075,leancloud:{app_id:"w5RAfQXjT6iFfBtGwiTfxQOP-gzGzoHsz",app_key:"h55viQ2cLIrigHjPHDfIS2ly",server_url:"https://w5rafqxj.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>var _hmt;Fluid.ctx.dnt||(_hmt=_hmt||[],function(){var t=document.createElement("script"),e=(t.src="https://hm.baidu.com/hm.js?3cb997f9d46af905b450452a8f181d9e",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}())</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-163962674-1","auto"),ga("send","pageview")})</script><script async src="https://www.google-analytics.com/analytics.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("//s4.cnzz.com/z_stat.php?id=1278827075&show=pic")</script><meta name="generator" content="Hexo 6.3.0"></head><script async src="https://www.googletagmanager.com/gtag/js?id=AW-715652541"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","AW-715652541")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-P4XN0EX1GY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P4XN0EX1GY")</script><body><header><div class="header-inner" style="height:40vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>潘高的小站</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-shijianzhou"></i> <span>时间轴</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/icp/"><i class="iconfont icon-icp"></i> <span>icp备案</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(https://pangao1990.gitee.io/pic/banner/myChat——第三方ChatGPT客户端又双叒叕更新啦.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.2)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="Python3的下一代HTTP客户端——HTTPX"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 潘高 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2023-04-18 18:00" pubdate>星期二, 四月 18日 2023, 6:00 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 6.5k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 33 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-1"></div><div class="col-lg-9 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">Python3的下一代HTTP客户端——HTTPX</h1><p class="note note-info">本文最后更新于：2023年4月18日 下午</p><div class="markdown-body"><h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>在 Python 中，访问网络资源最有名的库就是 <strong>requests</strong>、<strong>aiohttp</strong> 和 <strong>httpx</strong>。一般情况下，<strong>requests</strong> 只能发送同步请求；<strong>aiohttp</strong> 只能发送异步请求；<strong>httpx</strong> 既能发送同步请求，又能发送异步请求。</p><p>下面，就着重介绍一下 <a target="_blank" rel="noopener" href="https://www.python-httpx.org/">httpx</a> 的使用方法。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>使用 pip 安装 httpx：</p><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">pip <span class="hljs-keyword">install</span> httpx<br></code></pre></td></tr></table></figure><p>当然了，httpx 也可以使用命令行操作。不过，需要按如下命令安装。</p><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs nginx"><span class="hljs-attribute">pip</span> install <span class="hljs-string">&#x27;httpx[cli]&#x27;</span><br></code></pre></td></tr></table></figure><p><img src="https://pangao1990.gitee.io/pic/Python3%E7%9A%84%E4%B8%8B%E4%B8%80%E4%BB%A3HTTP%E5%AE%A2%E6%88%B7%E7%AB%AF%E2%80%94%E2%80%94HTTPX-1.png" srcset="/img/loading.gif" lazyload alt="image"></p><p>命令行测试发送请求:</p><p><img src="https://pangao1990.gitee.io/pic/Python3%E7%9A%84%E4%B8%8B%E4%B8%80%E4%BB%A3HTTP%E5%AE%A2%E6%88%B7%E7%AB%AF%E2%80%94%E2%80%94HTTPX-2.png" srcset="/img/loading.gif" lazyload alt="image"></p><h3 id="快速入门"><a href="#快速入门" class="headerlink" title="快速入门"></a>快速入门</h3><h4 id="发起-GET-请求"><a href="#发起-GET-请求" class="headerlink" title="发起 GET 请求"></a>发起 GET 请求</h4><p>直接用 <code>get</code> 方法，如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import httpx<br><br>r = httpx<span class="hljs-selector-class">.get</span>(<span class="hljs-string">&#x27;https://httpbin.org/get&#x27;</span>)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(r.status_code)</span></span>    #状态<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(r.text)</span></span>   #内容<br></code></pre></td></tr></table></figure><p>对于带参数的 URL，传入一个 dict 作为 params 参数，如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import httpx<br><br>r = httpx<span class="hljs-selector-class">.get</span>(<span class="hljs-string">&#x27;https://httpbin.org/get&#x27;</span>, params=&#123;<span class="hljs-string">&#x27;q&#x27;</span>: <span class="hljs-string">&#x27;python&#x27;</span>, <span class="hljs-string">&#x27;cat&#x27;</span>: <span class="hljs-string">&#x27;1001&#x27;</span>&#125;)<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(r.url)</span></span>    #实际请求的URL<br><span class="hljs-function"><span class="hljs-title">print</span><span class="hljs-params">(r.text)</span></span><br></code></pre></td></tr></table></figure><p>对于特定类型的响应，例如 JSON，可以直接获取，如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autoit">r = httpx.get(<span class="hljs-string">&#x27;https://httpbin.org/get&#x27;</span>)<br>r.json()<br><br><span class="hljs-meta"># &#123;<span class="hljs-string">&#x27;args&#x27;</span>: &#123;&#125;, <span class="hljs-string">&#x27;headers&#x27;</span>: &#123;<span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;*/*&#x27;</span>, <span class="hljs-string">&#x27;Accept-Encoding&#x27;</span>: ...</span><br></code></pre></td></tr></table></figure><p>对于非文本响应，响应内容也可以以字节的形式访问，如下：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">&gt;&gt;&gt; r.content<br>b&#x27;<span class="hljs-meta">&lt;!doctype <span class="hljs-keyword">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>\n<span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Example Domain<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>...&#x27;<br></code></pre></td></tr></table></figure><h4 id="添加-Headers"><a href="#添加-Headers" class="headerlink" title="添加 Headers"></a>添加 Headers</h4><p>需要传入 HTTP Header 时，我们传入一个 dict 作为 headers 参数，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">r</span> = httpx.get(<span class="hljs-string">&#x27;https://www.baidu.com/&#x27;</span>, headers=&#123;<span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (iPhone; CPU iPhone OS 11_0 like Mac OS X) AppleWebKit&#x27;</span>&#125;)<br></code></pre></td></tr></table></figure><p>获取响应头，如下：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">r.headers<br># &#123;Content-Typ<span class="hljs-string">e&#x27;: &#x27;</span><span class="hljs-type">text</span>/html; charset=utf<span class="hljs-number">-8</span><span class="hljs-string">&#x27;, &#x27;</span>Transfer-<span class="hljs-keyword">Encoding</span><span class="hljs-string">&#x27;: &#x27;</span>chunked<span class="hljs-string">&#x27;, &#x27;</span>Content-<span class="hljs-keyword">Encoding</span><span class="hljs-string">&#x27;: &#x27;</span>gzip<span class="hljs-string">&#x27;, ...&#125;</span><br><span class="hljs-string"></span><br><span class="hljs-string">r.headers[&#x27;</span>Content-Typ<span class="hljs-string">e&#x27;]</span><br><span class="hljs-string"># &#x27;</span><span class="hljs-type">text</span>/html; charset=utf<span class="hljs-number">-8</span><span class="hljs-string">&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="发起-POST-请求"><a href="#发起-POST-请求" class="headerlink" title="发起 POST 请求"></a>发起 POST 请求</h4><p>要发送 POST 请求，只需要把 get()方法变成 post()，然后传入 data 参数作为 POST 请求的数据，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">r</span> = httpx.post(<span class="hljs-string">&#x27;https://accounts.baidu.com/login&#x27;</span>, data=&#123;<span class="hljs-string">&#x27;form_email&#x27;</span>: <span class="hljs-string">&#x27;abc@example.com&#x27;</span>, <span class="hljs-string">&#x27;form_password&#x27;</span>: <span class="hljs-string">&#x27;123456&#x27;</span>&#125;)<br></code></pre></td></tr></table></figure><p>httpx 默认使用 application&#x2F;x-www-form-urlencoded 对 POST 数据编码。如果要传递 JSON 数据，可以直接传入 json 参数，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">params</span> = &#123;<span class="hljs-string">&#x27;key&#x27;</span>: <span class="hljs-string">&#x27;value&#x27;</span>&#125;<br><span class="hljs-attr">r</span> = httpx.post(url, json=params) <span class="hljs-comment">#内部自动序列化为JSON</span><br></code></pre></td></tr></table></figure><h4 id="发起二进制请求"><a href="#发起二进制请求" class="headerlink" title="发起二进制请求"></a>发起二进制请求</h4><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">content</span> = b<span class="hljs-string">&#x27;Hello, world&#x27;</span><br><span class="hljs-attr">r</span> = httpx.post(<span class="hljs-string">&quot;https://httpbin.org/post&quot;</span>, content=content)<br></code></pre></td></tr></table></figure><h4 id="上传文件"><a href="#上传文件" class="headerlink" title="上传文件"></a>上传文件</h4><p>上传文件操作如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">upload_files</span> = &#123;<span class="hljs-string">&#x27;upload-file&#x27;</span>: open(<span class="hljs-string">&#x27;report.xls&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)&#125;<br><span class="hljs-attr">r</span> = httpx.post(<span class="hljs-string">&#x27;https://httpbin.org/post&#x27;</span>, files=upload_files)<br></code></pre></td></tr></table></figure><p>如果需要在上传文件时包含非文件数据字段，请使用 data 参数，如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">data = &#123;<span class="hljs-string">&#x27;message&#x27;</span>: <span class="hljs-string">&#x27;Hello, world!&#x27;</span>&#125;<br>files = &#123;<span class="hljs-string">&#x27;file&#x27;</span>: open(<span class="hljs-string">&#x27;report.xls&#x27;</span>, <span class="hljs-string">&#x27;rb&#x27;</span>)&#125;<br>r = httpx.post(<span class="hljs-string">&quot;https://httpbin.org/post&quot;</span>, <span class="hljs-attribute">data</span>=data, <span class="hljs-attribute">files</span>=files)<br><span class="hljs-built_in">print</span>(r.text)<br></code></pre></td></tr></table></figure><h4 id="流媒体响应"><a href="#流媒体响应" class="headerlink" title="流媒体响应"></a>流媒体响应</h4><p>可以流式传输响应的二进制内容：</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">with</span> httpx.stream(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;https://www.example.com&quot;</span>) <span class="hljs-keyword">as</span> r:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    <span class="hljs-keyword">for</span> data <span class="hljs-keyword">in</span> r.iter_bytes():</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">        <span class="hljs-built_in">print</span>(data)</span><br></code></pre></td></tr></table></figure><p>或者返回文本:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">with</span> httpx.stream(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;https://www.example.com&quot;</span>) <span class="hljs-keyword">as</span> r:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    <span class="hljs-keyword">for</span> text <span class="hljs-keyword">in</span> r.iter_text():</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">        <span class="hljs-built_in">print</span>(text)</span><br></code></pre></td></tr></table></figure><p>或者逐行流式传输:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">with</span> httpx.stream(<span class="hljs-string">&quot;GET&quot;</span>, <span class="hljs-string">&quot;https://www.example.com&quot;</span>) <span class="hljs-keyword">as</span> r:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    <span class="hljs-keyword">for</span> line <span class="hljs-keyword">in</span> r.iter_lines():</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">        <span class="hljs-built_in">print</span>(line)</span><br></code></pre></td></tr></table></figure><h4 id="添加-Cookie"><a href="#添加-Cookie" class="headerlink" title="添加 Cookie"></a>添加 Cookie</h4><p>在请求中传入 Cookie，只需准备一个 dict 传入 cookies 参数，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">cs</span> = &#123;<span class="hljs-string">&#x27;token&#x27;</span>: <span class="hljs-string">&#x27;12345&#x27;</span>, <span class="hljs-string">&#x27;status&#x27;</span>: <span class="hljs-string">&#x27;working&#x27;</span>&#125;<br><span class="hljs-attr">r</span> = httpx.get(url, cookies=cs)<br></code></pre></td></tr></table></figure><p>httpx 对 Cookie 做了特殊处理，使得我们不必解析 Cookie 就可以轻松获取指定的 Cookie，如下：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">r.cookies[&#x27;token&#x27;]<br><span class="hljs-meta"># 12345</span><br></code></pre></td></tr></table></figure><h4 id="指定超时"><a href="#指定超时" class="headerlink" title="指定超时"></a>指定超时</h4><p>默认超时为 5 秒。要指定超时，传入以秒为单位的 timeout 参数。超时分为连接超时和读取超时，如下：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">try</span>:<br>    <span class="hljs-comment"># 3.1秒后连接超时，27秒后读取超时</span><br>    r = requests.<span class="hljs-keyword">get</span>(url, <span class="hljs-keyword">timeout</span>=(<span class="hljs-number">3.1</span>, <span class="hljs-number">27</span>))<br>except requests.exceptions.RequestException <span class="hljs-keyword">as</span> e:<br>    print(e)<br></code></pre></td></tr></table></figure><p>当然，也可以禁用超时：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">httpx.<span class="hljs-built_in">get</span>(<span class="hljs-string">&#x27;https://github.com/&#x27;</span>, <span class="hljs-attribute">timeout</span>=None)<br></code></pre></td></tr></table></figure><h4 id="超时重连"><a href="#超时重连" class="headerlink" title="超时重连"></a>超时重连</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs applescript">def gethtml(url):<br>    i = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">while</span> i &lt; <span class="hljs-number">3</span>:<br>        <span class="hljs-keyword">try</span>:<br>            html = httpx.<span class="hljs-keyword">get</span>(url, <span class="hljs-keyword">timeout</span>=<span class="hljs-number">5</span>).<span class="hljs-built_in">text</span><br><span class="hljs-built_in">            return</span> html<br>        except httpx.exceptions.RequestException:<br>            i += <span class="hljs-number">1</span><br></code></pre></td></tr></table></figure><h4 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h4><p>默认情况下，httpx 不会遵循所有 HTTP 方法的重定向，不过可以使用 follow_redirects 开启重定向：</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r = httpx.get(<span class="hljs-string">&#x27;http://github.com/&#x27;</span>, follow_redirects=<span class="hljs-literal">True</span>)</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r.url</span><br>URL(&#x27;https://github.com/&#x27;)<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r.status_code</span><br>200<br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r.history</span><br>[&lt;Response [301 Moved Permanently]&gt;]<br></code></pre></td></tr></table></figure><h3 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h3><p>使用 <strong>httpx.Client()</strong> ，实际上是调用 HTTP 链接池。可以带来显著的性能改进。包括：减少跨请求的延迟（无需握手），减少 CPU 使用和往返，减少网络拥塞。</p><h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><p>使用 Client 的推荐方式是作为上下文管理器。这将确保在离开 with 块时正确清理连接：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">with</span> httpx.<span class="hljs-constructor">Client()</span> <span class="hljs-keyword">as</span> client:<br>    ...<br></code></pre></td></tr></table></figure><p>或者，可以使用.close()显式关闭连接池，而无需使用块：</p><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs axapta"><span class="hljs-keyword">client</span> = httpx.Client()<br><span class="hljs-keyword">try</span>:<br>    ...<br><span class="hljs-keyword">finally</span>:<br>    <span class="hljs-keyword">client</span>.close()<br></code></pre></td></tr></table></figure><h4 id="发送请求"><a href="#发送请求" class="headerlink" title="发送请求"></a>发送请求</h4><p>一旦有了 Client，您可以使用.get().post()等发送请求。例如：</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">with</span> httpx.Client() <span class="hljs-keyword">as</span> client:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    r = client.get(<span class="hljs-string">&#x27;https://example.com&#x27;</span>)</span><br><span class="hljs-meta prompt_">...</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r</span><br>&lt;Response [200 OK]&gt;<br></code></pre></td></tr></table></figure><h4 id="跨请求共享配置"><a href="#跨请求共享配置" class="headerlink" title="跨请求共享配置"></a>跨请求共享配置</h4><p>Client 允许您通过将参数传递给 Client 构造函数来将配置应用于所有传出请求:</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">url = <span class="hljs-string">&#x27;http://httpbin.org/headers&#x27;</span></span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">headers = &#123;<span class="hljs-string">&#x27;user-agent&#x27;</span>: <span class="hljs-string">&#x27;my-app/0.0.1&#x27;</span>&#125;</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">with</span> httpx.Client(headers=headers) <span class="hljs-keyword">as</span> client:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    r = client.get(url)</span><br><span class="hljs-meta prompt_">...</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r.json()[<span class="hljs-string">&#x27;headers&#x27;</span>][<span class="hljs-string">&#x27;User-Agent&#x27;</span>]</span><br>&#x27;my-app/0.0.1&#x27;<br></code></pre></td></tr></table></figure><p>此外，base_url 允许您为所有传出请求预留 URL：</p><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">with</span> httpx.Client(base_url=<span class="hljs-string">&#x27;http://httpbin.org&#x27;</span>) <span class="hljs-keyword">as</span> client:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    r = client.get(<span class="hljs-string">&#x27;/headers&#x27;</span>)</span><br><span class="hljs-meta prompt_">...</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r.request.url</span><br>URL(&#x27;http://httpbin.org/headers&#x27;)<br></code></pre></td></tr></table></figure><h4 id="监控下载进度"><a href="#监控下载进度" class="headerlink" title="监控下载进度"></a>监控下载进度</h4><p>如果您需要监控大响应的下载进度，您可以使用响应流并检查 responseresponse.num_bytes_downloaded 属性:</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs stylus">import tempfile<br>import httpx<br><br>with tempfile<span class="hljs-selector-class">.NamedTemporaryFile</span>() as download_file:<br>    url = <span class="hljs-string">&quot;https://speed.hetzner.de/100MB.bin&quot;</span><br>    with httpx<span class="hljs-selector-class">.stream</span>(<span class="hljs-string">&quot;GET&quot;</span>, url) as response:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;response&#x27;</span>, response)<br>        total = <span class="hljs-built_in">int</span>(response<span class="hljs-selector-class">.headers</span><span class="hljs-selector-attr">[<span class="hljs-string">&quot;Content-Length&quot;</span>]</span>)<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;total&#x27;</span>, total)<br>        <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response<span class="hljs-selector-class">.iter_bytes</span>():<br>            download_file<span class="hljs-selector-class">.write</span>(chunk)<br>            percent = response<span class="hljs-selector-class">.num_bytes_downloaded</span> / total<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;percent: &#123;:.2%&#125;&#x27;</span><span class="hljs-selector-class">.format</span>(percent))<br></code></pre></td></tr></table></figure><h4 id="添加代理"><a href="#添加代理" class="headerlink" title="添加代理"></a>添加代理</h4><p>httpx 支持通过 proxies 参数设置 HTTP 代理：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-keyword">with</span> httpx.<span class="hljs-constructor">Client(<span class="hljs-params">proxies</span>=<span class="hljs-string">&quot;http://localhost:8030&quot;</span>)</span> <span class="hljs-keyword">as</span> client:<br>    ...<br></code></pre></td></tr></table></figure><p>对于更高级的用例，请传递代理 dict。例如，要将 HTTP 和 HTTPS 请求路由到 2 个不同的代理，分别位于 <a target="_blank" rel="noopener" href="http://localhost:8030/">http://localhost:8030</a> 和 <a href="http://localhost:8031，请传递代理">http://localhost:8031，请传递代理</a> URL：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">proxies = &#123;<br>    <span class="hljs-string">&quot;http://&quot;</span>: <span class="hljs-string">&quot;http://localhost:8030&quot;</span>,<br>    <span class="hljs-string">&quot;https://&quot;</span>: <span class="hljs-string">&quot;http://localhost:8031&quot;</span>,<br>&#125;<br><br><span class="hljs-keyword">with</span> httpx.<span class="hljs-constructor">Client(<span class="hljs-params">proxies</span>=<span class="hljs-params">proxies</span>)</span> <span class="hljs-keyword">as</span> client:<br>    ...<br></code></pre></td></tr></table></figure><p>代理凭据可以作为代理 URLuserinfo 部分传递:</p><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs makefile">proxies = &#123;<br>    <span class="hljs-string">&quot;http://&quot;</span>: <span class="hljs-string">&quot;http://username:password@localhost:8030&quot;</span>,<br>    <span class="hljs-comment"># ...</span><br>&#125;<br></code></pre></td></tr></table></figure><h3 id="异步支持"><a href="#异步支持" class="headerlink" title="异步支持"></a>异步支持</h3><h4 id="发送异步请求"><a href="#发送异步请求" class="headerlink" title="发送异步请求"></a>发送异步请求</h4><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> httpx.AsyncClient() <span class="hljs-keyword">as</span> client:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    r = <span class="hljs-keyword">await</span> client.get(<span class="hljs-string">&#x27;https://www.example.com/&#x27;</span>)</span><br><span class="hljs-meta prompt_">...</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">r</span><br>&lt;Response [200 OK]&gt;<br></code></pre></td></tr></table></figure><h4 id="打开和关闭-Client"><a href="#打开和关闭-Client" class="headerlink" title="打开和关闭 Client"></a>打开和关闭 Client</h4><p>使用 with：</p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> httpx.AsyncClient() <span class="hljs-keyword">as</span> client:<br>    ...<br></code></pre></td></tr></table></figure><p>显式关闭客户端:</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">client</span> <span class="hljs-operator">=</span> httpx.AsyncClient()<br>...<br>await client.aclose()<br></code></pre></td></tr></table></figure><h4 id="流媒体响应-1"><a href="#流媒体响应-1" class="headerlink" title="流媒体响应"></a>流媒体响应</h4><figure class="highlight python-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs python-repl"><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python">client = httpx.AsyncClient()</span><br><span class="hljs-meta prompt_">&gt;&gt;&gt;</span> <span class="language-python"><span class="hljs-keyword">async</span> <span class="hljs-keyword">with</span> client.stream(<span class="hljs-string">&#x27;GET&#x27;</span>, <span class="hljs-string">&#x27;https://www.example.com/&#x27;</span>) <span class="hljs-keyword">as</span> response:</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">    <span class="hljs-keyword">async</span> <span class="hljs-keyword">for</span> chunk <span class="hljs-keyword">in</span> response.aiter_bytes():</span><br><span class="hljs-meta prompt_">...</span> <span class="language-python">        ...</span><br></code></pre></td></tr></table></figure><p>异步响应流方法有：</p><ul><li>Response.aread()-用于有条件地读取流块内的响应。</li><li>Response.aiter_bytes()-用于将响应内容流化为字节。</li><li>Response.aiter_text()-用于将响应内容流化为文本。</li><li>Response.aiter_lines()-用于将响应内容流式传输为文本行。</li><li>Response.aiter_raw()-用于流式传输原始响应字节，无需应用内容解码。</li><li>Response.aclose()-用于结束回复。您通常不需要这个，因为.stream 块会在退出时自动关闭响应。</li></ul><hr><p>更多编程教学请关注公众号：<strong>潘高陪你学编程</strong></p><p><img src="https://pangao1990.gitee.io/pic/%E6%BD%98%E9%AB%98%E9%99%AA%E4%BD%A0%E5%AD%A6%E7%BC%96%E7%A8%8B.jpg" srcset="/img/loading.gif" lazyload alt="image"></p><hr></div><div><hr><div style="margin-top:20px;text-align:center"><div style="margin-bottom:10px">如果这篇文章对你有帮助，或者想给我微小的工作一点点资瓷，请随意打赏。</div><div id="QR" style="display:block"><div id="wechat" style="display:inline-block;margin-right:50px"><img id="wechat_qr" src="https://pangao1990.gitee.io/images/wechatpay.jpg" srcset="/img/loading.gif" lazyload alt="潘高 微信支付" style="width:150px;height:150px"><p style="color:#159718">微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="https://pangao1990.gitee.io/images/alipay.png" srcset="/img/loading.gif" lazyload alt="潘高 支付宝" style="width:150px;height:150px"><p style="color:#217cfb">支付宝</p></div></div></div><hr><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/HTTPX/" class="category-chain-item">HTTPX</a> <span>></span> <a href="/categories/HTTPX/Python/" class="category-chain-item">Python</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Python/">#Python</a> <a href="/tags/HTTPX/">#HTTPX</a></div></div><div class="license-box my-3"><div class="license-title"><div>Python3的下一代HTTP客户端——HTTPX</div><div>https://blog.pangao.vip/Python3的下一代HTTP客户端——HTTPX/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>潘高</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2023年4月18日 晚上</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2023年4月18日 下午</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"></article><article class="post-next col-6"><a href="/myChat%E2%80%94%E2%80%94%E7%AC%AC%E4%B8%89%E6%96%B9ChatGPT%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%88%E5%8F%8C%E5%8F%92%E5%8F%95%E6%9B%B4%E6%96%B0%E5%95%A6/" title="myChat——第三方ChatGPT客户端又双叒叕更新啦"><span class="hidden-mobile">myChat——第三方ChatGPT客户端又双叒叕更新啦</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5317369003185250" data-ad-slot="9014150860" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><br><hr><br><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",function(){Fluid.utils.createCssLink("https://cdn.staticfile.org/waline/2.14.1/waline.min.css"),Fluid.utils.createScript("https://cdn.staticfile.org/waline/2.14.1/waline.min.js",function(){var i=Object.assign({serverURL:"https://waline-1-p3250934.deta.app",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://unpkg.com/@waline/emojis@1.1.0/qq","https://unpkg.com/@waline/emojis@1.1.0/weibo"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10,avatar:"identicon",avatarCDN:"https://seccdn.libravatar.org/avatar/",avatarForce:!1,highlight:!0},{el:"#waline",path:window.location.pathname});Waline.init(i),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var i="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>评论功能在允许 JavaScript 运行的环境下效果更佳哦</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div class="col-lg-7 mx-auto nopadding-x-md"><div class="container custom mx-auto"><link rel="stylesheet" href="//at.alicdn.com/t/font_1765130_cg2uvt55y8.css"></div></div></main><footer><div class="footer-inner"><p id="hitokoto" style="color:#8a2be2">即将出现一段不可描述的话...</p><script>fetch("https://v1.hitokoto.cn").then(t=>t.json()).then(t=>{document.getElementById("hitokoto").innerText=t.hitokoto}).catch(console.error)</script><div><span id="timeDate">正在烧脑计算建站时间...</span> <span id="times"></span><script>var now=new Date;function createtime(){var n=new Date("02/23/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已默默无闻运行&nbsp"+dnum+"&nbsp天",document.getElementById("times").innerHTML=hnum+"&nbsp小时&nbsp"+mnum+"&nbsp分&nbsp"+snum+"&nbsp秒"}setInterval("createtime()",250)</script></div><div class="statistics"><span id="leancloud-site-uv-container" style="display:none">承蒙 <span id="leancloud-site-uv"></span> 位朋友 </span><span id="leancloud-site-pv-container" style="display:none">造访 <span id="leancloud-site-pv"></span> 次</span></div><div class="beian"><span><a href="/icp/blog.pangao.vip.html" target="_blank" rel="nofollow noopener">猿ICP证19901222号</a></span></div><span id="cnzz_stat_icon_1278827075" style="display:none"></span></div></footer><script src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://cdn.staticfile.org/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://cdn.staticfile.org/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://cdn.staticfile.org/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳哦</div></noscript></body></html>