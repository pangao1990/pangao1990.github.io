<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://pangao1990.gitee.io/images/favicon.jpg"><link rel="icon" href="https://pangao1990.gitee.io/images/favicon.jpg"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="潘高"><meta name="keywords" content="Perl,Excel,跨平台,linux,mac,pc,win"><meta name="description" content="perl可实现跨平台处理Excel，可以在mac、linux、pc上运行。"><meta property="og:type" content="article"><meta property="og:title" content="perl处理Excel(跨平台)"><meta property="og:url" content="https://blog.pangao.vip/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)/"><meta property="og:site_name" content="潘高的小站"><meta property="og:description" content="perl可实现跨平台处理Excel，可以在mac、linux、pc上运行。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pangao1990.gitee.io/pic/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)-1.png"><meta property="og:image" content="https://pangao1990.gitee.io/pic/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)-2.png"><meta property="article:published_time" content="2019-03-28T11:08:22.000Z"><meta property="article:modified_time" content="2023-04-25T07:27:19.094Z"><meta property="article:author" content="潘高"><meta property="article:tag" content="Perl"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://pangao1990.gitee.io/pic/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)-1.png"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5317369003185250" crossorigin="anonymous"></script><meta name="google-site-verification" content="google180fd90b1a12c24d.html"><title>perl处理Excel(跨平台) - 潘高的小站</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"blog.pangao.vip",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!1},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"3cb997f9d46af905b450452a8f181d9e",google:"UA-163962674-1",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:1278827075,leancloud:{app_id:"w5RAfQXjT6iFfBtGwiTfxQOP-gzGzoHsz",app_key:"h55viQ2cLIrigHjPHDfIS2ly",server_url:"https://w5rafqxj.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>var _hmt;Fluid.ctx.dnt||(_hmt=_hmt||[],function(){var t=document.createElement("script"),e=(t.src="https://hm.baidu.com/hm.js?3cb997f9d46af905b450452a8f181d9e",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}())</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-163962674-1","auto"),ga("send","pageview")})</script><script async src="https://www.google-analytics.com/analytics.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("//s4.cnzz.com/z_stat.php?id=1278827075&show=pic")</script><meta name="generator" content="Hexo 6.3.0"></head><script async src="https://www.googletagmanager.com/gtag/js?id=AW-715652541"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","AW-715652541")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-P4XN0EX1GY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P4XN0EX1GY")</script><body><header><div class="header-inner" style="height:40vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>潘高的小站</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-shijianzhou"></i> <span>时间轴</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/icp/"><i class="iconfont icon-icp"></i> <span>icp备案</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.2)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="perl处理Excel(跨平台)"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 潘高 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2019-03-28 19:08" pubdate>星期四, 三月 28日 2019, 7:08 晚上</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 20k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 100 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-1"></div><div class="col-lg-9 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">perl处理Excel(跨平台)</h1><p class="note note-info">本文最后更新于：2023年4月25日 下午</p><div class="markdown-body"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>用 perl 处理 excel 有两种流行的模块：一种是 <code>win32:OLE</code> 模块，优点是功能强大，在 excel 上能做的事情用这个模块都能做，缺点是无法跨平台，必须在 win 系统上使用且必须安装 office 软件；另一种是 <code>Spreadsheet</code> 模块，优点是跨平台，不依赖系统和软件，缺点是功能不是很多，但基本功能都能实现。</p><p>如果在 win 平台处理 excel，建议使用 <code>win32:OLE</code> 模块（<a href="https://blog.pangao.vip/Perl%E5%A4%84%E7%90%86Excel/">教程传送门</a>），本文主要讲解 <code>Spreadsheet</code> 模块的使用方法。</p><h2 id="了解"><a href="#了解" class="headerlink" title="了解"></a>了解</h2><p>从 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseExcel">Spreadsheet::ParseExcel</a> 和 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::WriteExcel">Spreadsheet::WriteExcel</a> 的官方资料中我们可以知道：</p><h5 id="Spreadsheet-ParseExcel"><a href="#Spreadsheet-ParseExcel" class="headerlink" title="Spreadsheet::ParseExcel"></a>Spreadsheet::ParseExcel</h5><ul><li>是用于提取 excel 信息</li><li>仅支持 Excel 95-2003 格式</li></ul><h5 id="Spreadsheet-WriteExcel"><a href="#Spreadsheet-WriteExcel" class="headerlink" title="Spreadsheet::WriteExcel"></a>Spreadsheet::WriteExcel</h5><ul><li>是用于新建 excel 信息</li><li>仅支持 Excel 97-2007 格式</li></ul><p>也就是说，如果想更好的支持 <code>xlsx</code> 格式的 excel 需要用到 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseXLSX">Spreadsheet::ParseXLSX</a> 和 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Excel::Writer::XLSX">Excel::Writer::XLSX</a> 模块。</p><blockquote><p>另外， <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseExcel::SaveParser">Spreadsheet::ParseExcel::SaveParser</a> 可以支持在已存在的 <code>xls</code> 表中修改数据，但是支持效果远没有 <code>win32:OLE</code> 模块强大，修改之后的表格会丢失部分不支持的宏命令和表格等，最遗憾的是仅支持 <code>xls</code> ，并不支持 <code>xlsx</code> 。</p></blockquote><h2 id="安装模块"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块</h2><p>在终端中输入 <code>sudo perl -MCPAN -e &quot;install &#39;Spreadsheet::ParseExcel&#39;&quot;</code> ，回车，如下图：</p><p><img src="https://pangao1990.gitee.io/pic/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)-1.png" srcset="/img/loading.gif" lazyload alt="image"></p><p>若出现如下图，则安装成功：</p><p><img src="https://pangao1990.gitee.io/pic/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)-2.png" srcset="/img/loading.gif" lazyload alt="image"></p><h2 id="使用方法-提取-Excel"><a href="#使用方法-提取-Excel" class="headerlink" title="使用方法 - 提取 Excel"></a>使用方法 - 提取 Excel</h2><p>引用 <code>use Spreadsheet::ParseExcel;</code> 类，如下：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-keyword">use</span> <span class="hljs-title class_">Spreadsheet</span>::<span class="hljs-title class_">ParseExcel</span>;<br></code></pre></td></tr></table></figure><h4 id="Parser"><a href="#Parser" class="headerlink" title="Parser"></a>Parser</h4><h6 id="new"><a href="#new" class="headerlink" title="new()"></a>new()</h6><p>new()方法可以新建一个提取类，如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">my <span class="hljs-variable">$parser</span> = <span class="hljs-title class_">Spreadsheet</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:ParseExcel-&gt;new</span>(); <span class="hljs-comment">#新建提取类</span><br></code></pre></td></tr></table></figure><p>若是 2007 版以上的 excel，则需要用到 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseXLSX">Spreadsheet::ParseXLSX</a> ，如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">use <span class="hljs-title class_">Spreadsheet</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:ParseXLSX</span>; <span class="hljs-comment">#引用</span><br>my <span class="hljs-variable">$parser</span> = <span class="hljs-title class_">Spreadsheet</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:ParseXLSX-&gt;new</span>(); <span class="hljs-comment">#新建xlsx提取类</span><br></code></pre></td></tr></table></figure><p>若 excel 需要密码才能打开，则新建密码提取类，如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby"><span class="hljs-variable">$parser</span> = <span class="hljs-title class_">Spreadsheet</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:ParseExcel-&gt;new</span>( <span class="hljs-title class_">Password</span> =&gt; <span class="hljs-string">&#x27;secret&#x27;</span> ); <span class="hljs-comment">#若excel需要密码才能打开，则新建密码提取类</span><br></code></pre></td></tr></table></figure><h6 id="parse-filename"><a href="#parse-filename" class="headerlink" title="parse($filename)"></a>parse($filename)</h6><p>获取 excel 表的工作薄，若无则返回 <code>under</code></p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $workbook = $parser-&gt;parse(<span class="hljs-string">&#x27;Book1.xls&#x27;</span>); <span class="hljs-comment">#获取excel表的工作薄，若无则返回 `under`</span><br></code></pre></td></tr></table></figure><h6 id="error"><a href="#error" class="headerlink" title="error()"></a>error()</h6><p>判断是否存在该 excel 表格</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># error_code() =&gt; error()</span><br><span class="hljs-meta"># ============    =======</span><br><span class="hljs-meta"># 0 =&gt; <span class="hljs-string">&#x27;&#x27;</span></span><br><span class="hljs-meta"># 1 =&gt; <span class="hljs-string">&#x27;文件没有找到&#x27;</span></span><br><span class="hljs-meta"># 2 =&gt; <span class="hljs-string">&#x27;该文件不是标准的excel格式文档&#x27;</span></span><br><span class="hljs-meta"># 3 =&gt; <span class="hljs-string">&#x27;文件加密了&#x27;</span></span><br><br><span class="hljs-keyword">if</span> ( !defined $workbook ) &#123; <span class="hljs-meta">#一般需要判断是否存在该excel表格</span><br>    die $parser-&gt;error_code(), $parser-&gt;error(), <span class="hljs-string">&quot;.\n&quot;</span><span class="hljs-comment">;</span><br>&#125;<br></code></pre></td></tr></table></figure><h4 id="Workbook"><a href="#Workbook" class="headerlink" title="Workbook"></a>Workbook</h4><p><code>Spreadsheet::ParseExcel::Workbook</code> 是由 <code>Spreadsheet::ParseExcel</code> 的 <code>parse()</code> 方法获得，有如下几种常用方法（<a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseExcel::Worksheet">完整方法使用传送门</a>）：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$workbook</span>-&gt;worksheets()</span><br><span class="hljs-meta"><span class="hljs-keyword">$workbook</span>-&gt;worksheet()</span><br><span class="hljs-meta"><span class="hljs-keyword">$workbook</span>-&gt;worksheet_count()</span><br><span class="hljs-meta"><span class="hljs-keyword">$workbook</span>-&gt;get_filename()</span><br></code></pre></td></tr></table></figure><h6 id="worksheets"><a href="#worksheets" class="headerlink" title="worksheets()"></a>worksheets()</h6><p>循环获取所有的 sheet 表，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">for</span> <span class="hljs-keyword">my</span> $worksheet ( $workbook-&gt;worksheets() ) &#123;<br>    <span class="hljs-comment">#循环获取所有的sheet表</span><br>    ...<br>&#125;<br></code></pre></td></tr></table></figure><h6 id="worksheet"><a href="#worksheet" class="headerlink" title="worksheet()"></a>worksheet()</h6><p>通过 sheet 表名或表索引获取单一 sheet 表，若无则返回 <code>under</code> ，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$worksheet</span> = <span class="hljs-variable">$workbook</span>-&gt;worksheet(<span class="hljs-string">&#x27;Sheet1&#x27;</span>); <span class="hljs-comment">#获取名为&quot;Sheet1&quot;的sheet表</span><br><span class="hljs-variable">$worksheet</span> = <span class="hljs-variable">$workbook</span>-&gt;worksheet(<span class="hljs-number">0</span>); <span class="hljs-comment">#获取第一张sheet表</span><br></code></pre></td></tr></table></figure><h6 id="worksheet-count"><a href="#worksheet-count" class="headerlink" title="worksheet_count()"></a>worksheet_count()</h6><p>获取 sheet 表的个数，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $worksheet_count = $workbook-&gt;worksheet_count(); <span class="hljs-comment">#获取sheet表的个数</span><br></code></pre></td></tr></table></figure><h6 id="get-filename"><a href="#get-filename" class="headerlink" title="get_filename()"></a>get_filename()</h6><p>获取 excel 表的全路径+名称，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $filename = $workbook-&gt;get_filename(); <span class="hljs-comment">#获取excel表的全路径+名称</span><br></code></pre></td></tr></table></figure><h4 id="Worksheet"><a href="#Worksheet" class="headerlink" title="Worksheet"></a>Worksheet</h4><p><code>Spreadsheet::ParseExcel::Worksheet</code> 是由 <code>worksheets()</code> 或 <code>worksheet()</code> 方法获得，有如下几种常用方法（<a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseExcel::Worksheet">完整方法使用传送门</a>）：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$worksheet</span>-&gt;get_cell()</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet</span>-&gt;row_range()</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet</span>-&gt;col_range()</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet</span>-&gt;get_name()</span><br></code></pre></td></tr></table></figure><h6 id="get-cell-row-col"><a href="#get-cell-row-col" class="headerlink" title="get_cell($row, $col)"></a>get_cell($row, $col)</h6><p>由指定行和列获取单元格，若不存在则返回 <code>under</code> ，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $cell = $worksheet-&gt;get_cell($row, $col); <span class="hljs-comment">#由指定行和列获取单元格</span><br></code></pre></td></tr></table></figure><h6 id="row-range"><a href="#row-range" class="headerlink" title="row_range()"></a>row_range()</h6><p>返回一个二元列表 <code>($min, $max)</code> ，表示行数的最小值和最大值，如下图：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> ( $row_min, $row_max ) = $worksheet-&gt;row_range(); <span class="hljs-comment">#行数的最小值和最大值</span><br></code></pre></td></tr></table></figure><h6 id="col-range"><a href="#col-range" class="headerlink" title="col_range()"></a>col_range()</h6><p>返回一个二元列表 <code>($min, $max)</code> ，表示列数的最小值和最大值，如下图：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> ( $col_min, $col_max ) = $worksheet-&gt;col_range(); <span class="hljs-comment">#列数的最小值和最大值</span><br></code></pre></td></tr></table></figure><h6 id="get-name"><a href="#get-name" class="headerlink" title="get_name()"></a>get_name()</h6><p>获取 sheet 的名称，如下图：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $name = $worksheet-&gt;get_name(); <span class="hljs-comment">#获取sheet的名称</span><br></code></pre></td></tr></table></figure><h4 id="Cell"><a href="#Cell" class="headerlink" title="Cell"></a>Cell</h4><p><code>Spreadsheet::ParseExcel::Cell</code> 有如下几种常用方法（<a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::ParseExcel::Cell">完整方法使用传送门</a>）：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$cell</span>-&gt;value()</span><br><span class="hljs-meta"><span class="hljs-keyword">$cell</span>-&gt;unformatted()</span><br></code></pre></td></tr></table></figure><h6 id="value"><a href="#value" class="headerlink" title="value()"></a>value()</h6><p>获取单元格的值(有格式)。例如，在单元格中输入数字 <code>123</code> ，单元格显示为 <code>123.00</code> ， 方法<code>value()</code> 的返回值为 <code>123.00</code> 。如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $value = $cell-&gt;value(); <span class="hljs-comment">#获取单元格的值(有格式)</span><br></code></pre></td></tr></table></figure><h6 id="unformatted"><a href="#unformatted" class="headerlink" title="unformatted()"></a>unformatted()</h6><p>获取单元格的值(无格式)。例如，在单元格中输入数字 <code>123</code> ，单元格显示为 <code>123.00</code> ，方法 <code>unformatted()</code> 的返回值为 <code>123</code> 。如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $value = $cell-&gt;unformatted(); <span class="hljs-comment">#获取单元格的值(有格式)</span><br></code></pre></td></tr></table></figure><h2 id="高级方法-提取-Excel"><a href="#高级方法-提取-Excel" class="headerlink" title="高级方法 - 提取 Excel"></a>高级方法 - 提取 Excel</h2><h4 id="Format"><a href="#Format" class="headerlink" title="Format"></a>Format</h4><p>获取 <code>单元格格式</code> ，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $format = $cell-&gt;get_format(); <span class="hljs-comment">#获取单元格格式</span><br></code></pre></td></tr></table></figure><p><code>Spreadsheet::ParseExcel::Format</code> 类有如下方法：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Font&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;AlignH&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;AlignV&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Indent&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Wrap&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Shrink&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Rotate&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;JustLast&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;ReadDir&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;BdrStyle&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;BdrColor&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;BdrDiag&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Fill&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Lock&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Hidden&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;&#123;Style&#125;</span><br></code></pre></td></tr></table></figure><h6 id="format-gt-Font"><a href="#format-gt-Font" class="headerlink" title="$format-&gt;{Font}"></a>$format-&gt;{Font}</h6><p>获取单元格的 <code>字体</code> ，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $font = $format-&gt;&#123;Font&#125;<br></code></pre></td></tr></table></figure><h6 id="format-gt-AlignH"><a href="#format-gt-AlignH" class="headerlink" title="$format-&gt;{AlignH}"></a>$format-&gt;{AlignH}</h6><p>获取单元格的 <code>水平对齐方式</code> ，返回值如下：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>=&gt; 常规<br><span class="hljs-symbol">1 </span>=&gt; 靠左<br><span class="hljs-symbol">2 </span>=&gt; 居中<br><span class="hljs-symbol">3 </span>=&gt; 靠右<br><span class="hljs-symbol">4 </span>=&gt; 填充<br><span class="hljs-symbol">5 </span>=&gt; 两端对齐<br><span class="hljs-symbol">6 </span>=&gt; 跨列居中<br><span class="hljs-symbol">7 </span>=&gt; 分散对齐<br></code></pre></td></tr></table></figure><h6 id="format-gt-Indent"><a href="#format-gt-Indent" class="headerlink" title="$format-&gt;{Indent}"></a>$format-&gt;{Indent}</h6><p>获取单元格的 <code>水平对齐方式</code> 中 <code>靠左</code> 的缩进值</p><h6 id="format-gt-AlignV"><a href="#format-gt-AlignV" class="headerlink" title="$format-&gt;{AlignV}"></a>$format-&gt;{AlignV}</h6><p>获取单元格的 <code>垂直对齐方式</code> ，返回值如下：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>=&gt; 靠上<br><span class="hljs-symbol">1 </span>=&gt; 居中<br><span class="hljs-symbol">2 </span>=&gt; 靠下<br><span class="hljs-symbol">3 </span>=&gt; 两端对齐<br><span class="hljs-symbol">4 </span>=&gt; 分散对齐<br></code></pre></td></tr></table></figure><h6 id="format-gt-Wrap"><a href="#format-gt-Wrap" class="headerlink" title="$format-&gt;{Wrap}"></a>$format-&gt;{Wrap}</h6><p>是否选择了 <code>文本控制</code> 中的 <code>自动换行</code></p><h6 id="format-gt-Shrink"><a href="#format-gt-Shrink" class="headerlink" title="$format-&gt;{Shrink}"></a>$format-&gt;{Shrink}</h6><p>是否选择了 <code>文本控制</code> 中的 <code>缩小字体填充</code></p><h6 id="format-gt-Rotate"><a href="#format-gt-Rotate" class="headerlink" title="$format-&gt;{Rotate}"></a>$format-&gt;{Rotate}</h6><p>获取 <code>字体旋转方向</code> ，如下：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>=&gt; 无<br><span class="hljs-symbol">1 </span>=&gt; 垂直<br><span class="hljs-symbol">2 </span>=&gt; 逆时针<span class="hljs-number">90</span>度<br><span class="hljs-symbol">3 </span>=&gt; 顺时针<span class="hljs-number">90</span>度<br></code></pre></td></tr></table></figure><h6 id="format-gt-JustLast"><a href="#format-gt-JustLast" class="headerlink" title="$format-&gt;{JustLast}"></a>$format-&gt;{JustLast}</h6><p>是否选择了 <code>两端分散对齐</code></p><h6 id="format-gt-ReadDir"><a href="#format-gt-ReadDir" class="headerlink" title="$format-&gt;{ReadDir}"></a>$format-&gt;{ReadDir}</h6><p>获取 <code>文本阅读方向</code></p><h6 id="format-gt-BdrStyle"><a href="#format-gt-BdrStyle" class="headerlink" title="$format-&gt;{BdrStyle}"></a>$format-&gt;{BdrStyle}</h6><p>获取 <code>边框线型</code> ，如下数组：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[ $left, $right, $top, $bottom ]<br></code></pre></td></tr></table></figure><h6 id="format-gt-BdrColor"><a href="#format-gt-BdrColor" class="headerlink" title="$format-&gt;{BdrColor}"></a>$format-&gt;{BdrColor}</h6><p>获取 <code>边框颜色</code> ，如下数组：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[ $left, $right, $top, $bottom ]<br></code></pre></td></tr></table></figure><h6 id="format-gt-BdrDiag"><a href="#format-gt-BdrDiag" class="headerlink" title="$format-&gt;{BdrDiag}"></a>$format-&gt;{BdrDiag}</h6><p>获取 <code>对角线边框种类、线型、颜色</code> ，如下数组：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[$kind, $style, $color ]<br></code></pre></td></tr></table></figure><p>边框种类如下：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>=&gt; 无<br><span class="hljs-symbol">1 </span>=&gt; 右上对角线<br><span class="hljs-symbol">2 </span>=&gt; 右下对角线<br><span class="hljs-symbol">3 </span>=&gt; 全部<br></code></pre></td></tr></table></figure><h6 id="format-gt-Fill"><a href="#format-gt-Fill" class="headerlink" title="$format-&gt;{Fill}"></a>$format-&gt;{Fill}</h6><p>获取 <code>填充</code> 的 <code>图案样式</code> 、 <code>图案颜色</code> 、 <code>背景色</code> ，如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[ $pattern, $front_color, $back_color ]<br></code></pre></td></tr></table></figure><h6 id="format-gt-Lock"><a href="#format-gt-Lock" class="headerlink" title="$format-&gt;{Lock}"></a>$format-&gt;{Lock}</h6><p>获取是否 <code>锁定</code> 单元格</p><h6 id="format-gt-Hidden"><a href="#format-gt-Hidden" class="headerlink" title="$format-&gt;{Hidden}"></a>$format-&gt;{Hidden}</h6><p>获取是否 <code>隐藏</code> 公式</p><h4 id="Font"><a href="#Font" class="headerlink" title="Font"></a>Font</h4><p>获取单元格的 <code>字体</code> ，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $font = $format-&gt;&#123;Font&#125;<br></code></pre></td></tr></table></figure><p><code>Spreadsheet::ParseExcel::Font</code> 类有如下方法：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Name&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Bold&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Italic&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Height&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Underline&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;UnderlineStyle&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Color&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Strikeout&#125;</span><br><span class="hljs-meta"><span class="hljs-keyword">$font</span>-&gt;&#123;Super&#125;</span><br></code></pre></td></tr></table></figure><h6 id="font-gt-Name"><a href="#font-gt-Name" class="headerlink" title="$font-&gt;{Name}"></a>$font-&gt;{Name}</h6><p>获取 <code>字体名称</code> ，如 <code>Arial</code></p><h6 id="font-gt-Bold"><a href="#font-gt-Bold" class="headerlink" title="$font-&gt;{Bold}"></a>$font-&gt;{Bold}</h6><p>获取字体是否 <code>加粗</code></p><h6 id="font-gt-Italic"><a href="#font-gt-Italic" class="headerlink" title="$font-&gt;{Italic}"></a>$font-&gt;{Italic}</h6><p>获取字体是否 <code>斜体</code></p><h6 id="font-gt-Height"><a href="#font-gt-Height" class="headerlink" title="$font-&gt;{Height}"></a>$font-&gt;{Height}</h6><p>获取字体 <code>大小</code></p><h6 id="font-gt-Underline"><a href="#font-gt-Underline" class="headerlink" title="$font-&gt;{Underline}"></a>$font-&gt;{Underline}</h6><p>获取字体是否开启 <code>下划线</code></p><h6 id="font-gt-UnderlineStyle"><a href="#font-gt-UnderlineStyle" class="headerlink" title="$font-&gt;{UnderlineStyle}"></a>$font-&gt;{UnderlineStyle}</h6><p>获取字体 <code>下划线样式</code> ，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs ini"> <span class="hljs-attr">0</span> =&gt; 无<br> <span class="hljs-attr">1</span> =&gt; 下划线<br> <span class="hljs-attr">2</span> =&gt; 双下划线<br><span class="hljs-attr">33</span> =&gt; Single accounting<br><span class="hljs-attr">34</span> =&gt; Double accounting<br></code></pre></td></tr></table></figure><h6 id="font-gt-Color"><a href="#font-gt-Color" class="headerlink" title="$font-&gt;{Color}"></a>$font-&gt;{Color}</h6><p>获取 <code>字体颜色</code></p><h6 id="font-gt-Strikeout"><a href="#font-gt-Strikeout" class="headerlink" title="$font-&gt;{Strikeout}"></a>$font-&gt;{Strikeout}</h6><p>获取字体是否添加 <code>删除线</code></p><h6 id="font-gt-Super"><a href="#font-gt-Super" class="headerlink" title="$font-&gt;{Super}"></a>$font-&gt;{Super}</h6><p>获取字体是 <code>上标</code> 还是 <code>下标</code> ，如下：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>=&gt; 无<br><span class="hljs-symbol">1 </span>=&gt; 上标<br><span class="hljs-symbol">2 </span>=&gt; 下标<br></code></pre></td></tr></table></figure><h2 id="使用方法-新建-Excel"><a href="#使用方法-新建-Excel" class="headerlink" title="使用方法 - 新建 Excel"></a>使用方法 - 新建 Excel</h2><p>引用 <code>use Spreadsheet::WriteExcel;</code> 类，如下：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-keyword">use</span> <span class="hljs-title class_">Spreadsheet</span>::<span class="hljs-title class_">WriteExcel</span>;<br></code></pre></td></tr></table></figure><h4 id="workbook"><a href="#workbook" class="headerlink" title="workbook"></a>workbook</h4><h6 id="new-1"><a href="#new-1" class="headerlink" title="new()"></a>new()</h6><p>new()方法可以基于文件名新建一个 excel 表，如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">my <span class="hljs-variable">$workbook</span>  = <span class="hljs-title class_">Spreadsheet</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:WriteExcel-&gt;new</span>(<span class="hljs-string">&#x27;filename.xls&#x27;</span>); <span class="hljs-comment">#新建xls表</span><br></code></pre></td></tr></table></figure><p>若是新建 2007 版以上的 excel，则需要用到 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Excel::Writer::XLSX">Excel::Writer::XLSX</a> ，如下：</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ruby">use <span class="hljs-title class_">Excel</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Writer</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:XLSX</span>; <span class="hljs-comment">#引用</span><br>my <span class="hljs-variable">$workbook</span> = <span class="hljs-title class_">Excel</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:Writer</span><span class="hljs-symbol">:</span><span class="hljs-symbol">:XLSX-&gt;new</span>( <span class="hljs-string">&#x27;perl.xlsx&#x27;</span> ); <span class="hljs-comment">#新建xlsx表</span><br></code></pre></td></tr></table></figure><p>若创建失败，则返回 under，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">die</span> <span class="hljs-string">&quot;Problems creating new Excel file: $!&quot;</span> <span class="hljs-keyword">unless</span> <span class="hljs-keyword">defined</span> $workbook;<br></code></pre></td></tr></table></figure><h6 id="compatibility-mode"><a href="#compatibility-mode" class="headerlink" title="compatibility_mode()"></a>compatibility_mode()</h6><p>用于增强兼容性，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$workbook</span>-&gt;compatibility_mode(); <span class="hljs-comment">#用于增强兼容性</span><br></code></pre></td></tr></table></figure><h6 id="add-worksheet-sheetname"><a href="#add-worksheet-sheetname" class="headerlink" title="add_worksheet($sheetname)"></a>add_worksheet($sheetname)</h6><p>新增一个 sheet，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$worksheet1</span> = <span class="hljs-variable">$workbook</span>-&gt;add_worksheet();           <span class="hljs-comment"># Sheet1</span><br><span class="hljs-variable">$worksheet2</span> = <span class="hljs-variable">$workbook</span>-&gt;add_worksheet(<span class="hljs-string">&#x27;自定义名称&#x27;</span>);  <span class="hljs-comment"># 自定义名称</span><br><span class="hljs-variable">$worksheet3</span> = <span class="hljs-variable">$workbook</span>-&gt;add_worksheet();           <span class="hljs-comment"># Sheet3</span><br></code></pre></td></tr></table></figure><h6 id="add-chart-properties"><a href="#add-chart-properties" class="headerlink" title="add_chart(%properties)"></a>add_chart(%properties)</h6><p>更多详细请移步 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::WriteExcel::Chart">Spreadsheet::WriteExcel::Chart</a></p><h6 id="close"><a href="#close" class="headerlink" title="close()"></a>close()</h6><p>一般情况下，excel 文件会自动关闭，但使用 <code>close()</code> 可以确定关闭 excel 文件，如下：</p><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">$workbook-&gt;<span class="hljs-keyword">close() </span><span class="hljs-keyword">or </span><span class="hljs-keyword">die </span><span class="hljs-string">&quot;Error closing file: $!&quot;</span><span class="hljs-comment">; #关闭excel文件</span><br></code></pre></td></tr></table></figure><h6 id="set-properties"><a href="#set-properties" class="headerlink" title="set_properties()"></a>set_properties()</h6><p>设置 excel 表附加信息，如下：</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sml">#设置excel表附加信息<br>$workbook-&gt;set_properties(<br>    title    =&gt; <span class="hljs-symbol">&#x27;This</span> is an example spreadsheet&#x27;,<br>    author   =&gt; <span class="hljs-symbol">&#x27;John</span> <span class="hljs-type">McNamara&#x27;</span>,<br>    comments =&gt; <span class="hljs-symbol">&#x27;Created</span> <span class="hljs-keyword">with</span> <span class="hljs-type">Perl</span> <span class="hljs-keyword">and</span> <span class="hljs-type">Spreadsheet</span>::<span class="hljs-type">WriteExcel&#x27;</span>,<br>);<br></code></pre></td></tr></table></figure><p>可设置的信息如下：</p><figure class="highlight dos"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs dos"><span class="hljs-built_in">title</span><br>subject<br>author<br>manager<br>company<br>category<br>keywords<br>comments<br></code></pre></td></tr></table></figure><h4 id="worksheet-1"><a href="#worksheet-1" class="headerlink" title="worksheet"></a>worksheet</h4><h6 id="write-row-column-token-format"><a href="#write-row-column-token-format" class="headerlink" title="write($row, $column, $token, $format)"></a>write($row, $column, $token, $format)</h6><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs perl">$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;Hello&#x27;</span>                ); <span class="hljs-comment"># write_string()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;One&#x27;</span>                  ); <span class="hljs-comment"># write_string()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">2</span>                     ); <span class="hljs-comment"># write_number()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">3</span>, <span class="hljs-number">0</span>,  <span class="hljs-number">3.00001</span>               ); <span class="hljs-comment"># write_number()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">4</span>, <span class="hljs-number">0</span>,  <span class="hljs-string">&quot;&quot;</span>                    ); <span class="hljs-comment"># write_blank()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">5</span>, <span class="hljs-number">0</span>,  <span class="hljs-string">&#x27;&#x27;</span>                    ); <span class="hljs-comment"># write_blank()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">6</span>, <span class="hljs-number">0</span>,  <span class="hljs-keyword">undef</span>                 ); <span class="hljs-comment"># write_blank()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">7</span>, <span class="hljs-number">0</span>                         ); <span class="hljs-comment"># write_blank()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">8</span>, <span class="hljs-number">0</span>,  <span class="hljs-string">&#x27;http://www.perl.com/&#x27;</span>); <span class="hljs-comment"># write_url()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A9&#x27;</span>,  <span class="hljs-string">&#x27;ftp://ftp.cpan.org/&#x27;</span> ); <span class="hljs-comment"># write_url()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A10&#x27;</span>, <span class="hljs-string">&#x27;internal:Sheet1!A1&#x27;</span>  ); <span class="hljs-comment"># write_url()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A11&#x27;</span>, <span class="hljs-string">&#x27;external:c:\foo.xls&#x27;</span> ); <span class="hljs-comment"># write_url()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A12&#x27;</span>, <span class="hljs-string">&#x27;=A3 + 3*A4&#x27;</span>          ); <span class="hljs-comment"># write_formula()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A13&#x27;</span>, <span class="hljs-string">&#x27;=SIN(PI()/4)&#x27;</span>        ); <span class="hljs-comment"># write_formula()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A14&#x27;</span>, \@array               ); <span class="hljs-comment"># write_row()</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A15&#x27;</span>, [\@array]             ); <span class="hljs-comment"># write_col()</span><br></code></pre></td></tr></table></figure><p><code>$format</code> 参数是可选的，用于定义单元格的格式，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $format = $workbook-&gt;add_format();<br>$format-&gt;set_bold(); <span class="hljs-comment">#加粗</span><br>$format-&gt;set_color(<span class="hljs-string">&#x27;red&#x27;</span>); <span class="hljs-comment">#字体红色</span><br>$format-&gt;set_align(<span class="hljs-string">&#x27;center&#x27;</span>); <span class="hljs-comment">#居中</span><br><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">4</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;Hello&#x27;</span>, $format);<br></code></pre></td></tr></table></figure><p>单元格坐标的确认使用格式如下：</p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name">0</span>, <span class="hljs-number">0</span>)<br>(<span class="hljs-symbol">&#x27;A1</span>&#x27;)<br></code></pre></td></tr></table></figure><p>互换使用方法如下：</p><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elixir"><span class="hljs-keyword">use</span> <span class="hljs-title class_">Spreadsheet</span>::<span class="hljs-title class_">WriteExcel</span>::<span class="hljs-title class_">Utility</span>;<br><br>(<span class="hljs-variable">$row</span>, <span class="hljs-variable">$col</span>) = xl_cell_to_rowcol(<span class="hljs-string">&#x27;C2&#x27;</span>);  <span class="hljs-comment"># (1, 2)</span><br><span class="hljs-variable">$str</span> = xl_rowcol_to_cell(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>);  <span class="hljs-comment"># C2</span><br></code></pre></td></tr></table></figure><h6 id="keep-leading-zeros"><a href="#keep-leading-zeros" class="headerlink" title="keep_leading_zeros()"></a>keep_leading_zeros()</h6><p>excel 会将类似于数字的内容转换成数字，例如输入 <code>0123</code> ，excel 会将它转化为 <code>123</code> ，如果想呈现出 <code>0123</code> ，则做如下处理：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-comment"># 如下，结果是 1209</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A1&#x27;</span>, <span class="hljs-string">&#x27;01209&#x27;</span>);<br><br><span class="hljs-comment"># 设置格式，结果是 01209</span><br><span class="hljs-keyword">my</span> $format1 = $workbook-&gt;add_format(<span class="hljs-string">num_format =&gt;</span> <span class="hljs-string">&#x27;00000&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A2&#x27;</span>, <span class="hljs-string">&#x27;01209&#x27;</span>, $format1);<br><br><span class="hljs-comment"># 使用字符串格式，结果是 01209</span><br>$worksheet-&gt;write_string(<span class="hljs-string">&#x27;A3&#x27;</span>, <span class="hljs-string">&#x27;01209&#x27;</span>);<br><br><span class="hljs-comment"># 使用keep_leading_zeros()方法，结果是 01209</span><br>$worksheet-&gt;keep_leading_zeros();<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A4&#x27;</span>, <span class="hljs-string">&#x27;01209&#x27;</span>);<br></code></pre></td></tr></table></figure><p>以上操作呈现出的效果如下：</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"> -----------------------------------------------------------<br>|<span class="hljs-string">   </span>|<span class="hljs-string">     A     </span>|<span class="hljs-string">     B     </span>|<span class="hljs-string">     C     </span>|<span class="hljs-string">     D     </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"> -----------------------------------------------------------</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 1 </span>|<span class="hljs-string">      1209 </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 2 </span>|<span class="hljs-string">     01209 </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> 01209     </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 4 </span>|<span class="hljs-string"> 01209     </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string">           </span>|<span class="hljs-string"> ...</span><br></code></pre></td></tr></table></figure><p>write_row($row, $column, $array_ref, $format) 写入数组数据，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs perl">@array      = (<span class="hljs-string">&#x27;awk&#x27;</span>, <span class="hljs-string">&#x27;gawk&#x27;</span>, <span class="hljs-string">&#x27;mawk&#x27;</span>);<br>$array_ref  = \@array;<br><br>$worksheet-&gt;write_row(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, $array_ref);<br><br><span class="hljs-comment"># 以上代码等价于</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, $array[<span class="hljs-number">0</span>]);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, $array[<span class="hljs-number">1</span>]);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>, <span class="hljs-number">2</span>, $array[<span class="hljs-number">2</span>]);<br></code></pre></td></tr></table></figure><p>若是二维数组，如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-symbol">@eec</span> =  (<br>            [<span class="hljs-string">&#x27;maggie&#x27;</span>, <span class="hljs-string">&#x27;milly&#x27;</span>, <span class="hljs-string">&#x27;molly&#x27;</span>, <span class="hljs-string">&#x27;may&#x27;</span>  ],<br>            [<span class="hljs-number">13</span>,       <span class="hljs-number">14</span>,      <span class="hljs-number">15</span>,      <span class="hljs-number">16</span>     ],<br>            [<span class="hljs-string">&#x27;shell&#x27;</span>,  <span class="hljs-string">&#x27;star&#x27;</span>,  <span class="hljs-string">&#x27;crab&#x27;</span>,  <span class="hljs-string">&#x27;stone&#x27;</span>]<br>        )<span class="hljs-comment">;</span><br><br>$worksheet-&gt;write_row(<span class="hljs-string">&#x27;A1&#x27;</span>, \<span class="hljs-symbol">@eec</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>呈现出的效果，如下：</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gherkin"> -----------------------------------------------------------<br>|<span class="hljs-string">   </span>|<span class="hljs-string">    A    </span>|<span class="hljs-string">    B    </span>|<span class="hljs-string">    C    </span>|<span class="hljs-string">    D    </span>|<span class="hljs-string">    E    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"> -----------------------------------------------------------</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> maggie  </span>|<span class="hljs-string"> 13      </span>|<span class="hljs-string"> shell   </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> milly   </span>|<span class="hljs-string"> 14      </span>|<span class="hljs-string"> star    </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> molly   </span>|<span class="hljs-string"> 15      </span>|<span class="hljs-string"> crab    </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 4 </span>|<span class="hljs-string"> may     </span>|<span class="hljs-string"> 16      </span>|<span class="hljs-string"> stone   </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 5 </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 6 </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br></code></pre></td></tr></table></figure><p>write_col($row, $column, $array_ref, $format) 写入数组数据，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs perl">@array      = (<span class="hljs-string">&#x27;awk&#x27;</span>, <span class="hljs-string">&#x27;gawk&#x27;</span>, <span class="hljs-string">&#x27;mawk&#x27;</span>);<br>$array_ref  = \@array;<br><br>$worksheet-&gt;write_col(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, $array_ref);<br><br><span class="hljs-comment"># 以上代码等价于</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, $array[<span class="hljs-number">0</span>]);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, $array[<span class="hljs-number">1</span>]);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, $array[<span class="hljs-number">2</span>]);<br></code></pre></td></tr></table></figure><p>若是二维数组，如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-symbol">@eec</span> =  (<br>            [<span class="hljs-string">&#x27;maggie&#x27;</span>, <span class="hljs-string">&#x27;milly&#x27;</span>, <span class="hljs-string">&#x27;molly&#x27;</span>, <span class="hljs-string">&#x27;may&#x27;</span>  ],<br>            [<span class="hljs-number">13</span>,       <span class="hljs-number">14</span>,      <span class="hljs-number">15</span>,      <span class="hljs-number">16</span>     ],<br>            [<span class="hljs-string">&#x27;shell&#x27;</span>,  <span class="hljs-string">&#x27;star&#x27;</span>,  <span class="hljs-string">&#x27;crab&#x27;</span>,  <span class="hljs-string">&#x27;stone&#x27;</span>]<br>        )<span class="hljs-comment">;</span><br><br>$worksheet-&gt;write_col(<span class="hljs-string">&#x27;A1&#x27;</span>, \<span class="hljs-symbol">@eec</span>)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><p>呈现出的效果，如下：</p><figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gherkin">  -----------------------------------------------------------<br>|<span class="hljs-string">   </span>|<span class="hljs-string">    A    </span>|<span class="hljs-string">    B    </span>|<span class="hljs-string">    C    </span>|<span class="hljs-string">    D    </span>|<span class="hljs-string">    E    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"> -----------------------------------------------------------</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 1 </span>|<span class="hljs-string"> maggie  </span>|<span class="hljs-string"> milly   </span>|<span class="hljs-string"> molly   </span>|<span class="hljs-string"> may     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 2 </span>|<span class="hljs-string"> 13      </span>|<span class="hljs-string"> 14      </span>|<span class="hljs-string"> 15      </span>|<span class="hljs-string"> 16      </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 3 </span>|<span class="hljs-string"> shell   </span>|<span class="hljs-string"> star    </span>|<span class="hljs-string"> crab    </span>|<span class="hljs-string"> stone   </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 4 </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 5 </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br><span class="hljs-string"></span>|<span class="hljs-string"> 6 </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string"> ...     </span>|<span class="hljs-string">  ...    </span>|<span class="hljs-string"> ...</span><br></code></pre></td></tr></table></figure><h6 id="write-url-row-col-url-label-format"><a href="#write-url-row-col-url-label-format" class="headerlink" title="write_url($row, $col, $url, $label, $format)"></a>write_url($row, $col, $url, $label, $format)</h6><p>写入超链接，如下：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">$worksheet-&gt;write<span class="hljs-constructor">_url(0, 0,  &#x27;<span class="hljs-params">ftp</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">www</span>.<span class="hljs-params">perl</span>.<span class="hljs-params">org</span><span class="hljs-operator">/</span>&#x27;                  )</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(1, 0,  &#x27;<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">www</span>.<span class="hljs-params">perl</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span>&#x27;, &#x27;Perl <span class="hljs-params">home</span>&#x27;    )</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(&#x27;A3&#x27;,  &#x27;<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">www</span>.<span class="hljs-params">perl</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span>&#x27;, $<span class="hljs-params">format</span>        )</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(&#x27;A4&#x27;,  &#x27;<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">www</span>.<span class="hljs-params">perl</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span>&#x27;, &#x27;Perl&#x27;, $<span class="hljs-params">format</span>)</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(&#x27;A5&#x27;,  &#x27;<span class="hljs-params">mailto</span>:<span class="hljs-params">jmcnamara</span>@<span class="hljs-params">cpan</span>.<span class="hljs-params">org</span>&#x27;            )</span>;<br></code></pre></td></tr></table></figure><h6 id="write-url-range-row1-col1-row2-col2-url-string-format"><a href="#write-url-range-row1-col1-row2-col2-url-string-format" class="headerlink" title="write_url_range($row1, $col1, $row2, $col2, $url, $string, $format)"></a>write_url_range($row1, $col1, $row2, $col2, $url, $string, $format)</h6><p>在一块区域内写入超链接，如下：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">$worksheet-&gt;write<span class="hljs-constructor">_url(0, 0, 0, 3, &#x27;<span class="hljs-params">ftp</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">www</span>.<span class="hljs-params">perl</span>.<span class="hljs-params">org</span><span class="hljs-operator">/</span>&#x27;              )</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(1, 0, 0, 3, &#x27;<span class="hljs-params">http</span>:<span class="hljs-operator">/</span><span class="hljs-operator">/</span><span class="hljs-params">www</span>.<span class="hljs-params">perl</span>.<span class="hljs-params">com</span><span class="hljs-operator">/</span>&#x27;, &#x27;Perl <span class="hljs-params">home</span>&#x27;)</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(&#x27;A3:D3&#x27;,    &#x27;<span class="hljs-params">internal</span>:Sheet2!A1&#x27;               )</span>;<br>$worksheet-&gt;write<span class="hljs-constructor">_url(&#x27;A4:D4&#x27;,    &#x27;<span class="hljs-params">external</span>:<span class="hljs-params">c</span>:\<span class="hljs-params">temp</span>\<span class="hljs-params">foo</span>.<span class="hljs-params">xls</span>&#x27;         )</span>;<br><br></code></pre></td></tr></table></figure><h6 id="write-formula-row-column-formula-format-value"><a href="#write-formula-row-column-formula-format-value" class="headerlink" title="write_formula($row, $column, $formula, $format, $value)"></a>write_formula($row, $column, $formula, $format, $value)</h6><p>写入公式，如下：</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_formula(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;=$B$3 + B4&#x27;</span>  );<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_formula(<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;=SIN(PI()/4)&#x27;</span>);<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_formula(<span class="hljs-number">2</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;=SUM(B1:B5)&#x27;</span> );<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_formula(<span class="hljs-string">&#x27;A4&#x27;</span>, <span class="hljs-string">&#x27;=IF(A3&gt;1,&quot;Yes&quot;, &quot;No&quot;)&#x27;</span>   );<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_formula(<span class="hljs-string">&#x27;A5&#x27;</span>, <span class="hljs-string">&#x27;=AVERAGE(1, 2, 3, 4)&#x27;</span>    );<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_formula(<span class="hljs-string">&#x27;A6&#x27;</span>, <span class="hljs-string">&#x27;=DATEVALUE(&quot;1-Jan-2001&quot;)&#x27;</span>);<br></code></pre></td></tr></table></figure><h6 id="write-comment-row-column-string-…"><a href="#write-comment-row-column-string-…" class="headerlink" title="write_comment($row, $column, $string, …)"></a>write_comment($row, $column, $string, …)</h6><p>增加批注，如下：</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write        (<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;Hello&#x27;</span>);<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>write_comment(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-string">&#x27;这是个批注&#x27;</span>);<br></code></pre></td></tr></table></figure><p>还可以增加信息如下：</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-comment"># encoding =&gt; 若为1，则表明使用UTF-16BE编码</span><br><span class="hljs-comment"># author =&gt; 批注的作者</span><br><span class="hljs-comment"># author_encoding =&gt; 作者字符串是否用UTF-16BE编码</span><br><span class="hljs-comment"># visible =&gt; 是否设置开启excel时批注可见。1为可见；0为不可见</span><br><span class="hljs-comment"># x_scale =&gt; 设置批注框宽度的压缩比</span><br><span class="hljs-comment"># width =&gt; 设置批注框宽度</span><br><span class="hljs-comment"># y_scale =&gt; 设置批注框高度的压缩比</span><br><span class="hljs-comment"># height =&gt; 设置批注框高度</span><br><span class="hljs-comment"># color =&gt; 设置批注框背景色</span><br><span class="hljs-comment"># start_cell =&gt; 设置批注框出现的位置，如“E2”</span><br><span class="hljs-comment"># start_row =&gt; 设置批注框出现的行位置</span><br><span class="hljs-comment"># start_col =&gt; 设置批注框出现的列位置</span><br><br>$worksheet-&gt;write_comment(<span class="hljs-string">&#x27;C3&#x27;</span>, <span class="hljs-string">&#x27;Hello&#x27;</span>, visible =&gt; <span class="hljs-number">1</span>, author =&gt; <span class="hljs-string">&#x27;Perl&#x27;</span>);<br></code></pre></td></tr></table></figure><h6 id="insert-image-row-col-filename-x-y-scale-x-scale-y"><a href="#insert-image-row-col-filename-x-y-scale-x-scale-y" class="headerlink" title="insert_image($row, $col, $filename, $x, $y, $scale_x, $scale_y)"></a>insert_image($row, $col, $filename, $x, $y, $scale_x, $scale_y)</h6><p>在 sheet 中插入一个 png、jpeg 或 bmp 格式的图片， <code>$x</code> 和 <code>$y</code> 表示在单元格中图片靠左和靠上的距离， <code>$scale_x</code> 和 <code>$scale_y</code> 表示缩放比例，如下：</p><figure class="highlight sml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sml">$worksheet-&gt;insert_image(<span class="hljs-symbol">&#x27;A1&#x27;</span>, <span class="hljs-symbol">&#x27;perl</span>.bmp&#x27;, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">2</span>, <span class="hljs-number">0.8</span>);<br></code></pre></td></tr></table></figure><h6 id="insert-chart-row-col-chart-x-y-scale-x-scale-y"><a href="#insert-chart-row-col-chart-x-y-scale-x-scale-y" class="headerlink" title="insert_chart($row, $col, $chart, $x, $y, $scale_x, $scale_y)"></a>insert_chart($row, $col, $chart, $x, $y, $scale_x, $scale_y)</h6><p>插入表格，详情请移步 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::WriteExcel::Chart">Spreadsheet::WriteExcel::Chart</a></p><h6 id="data-validation"><a href="#data-validation" class="headerlink" title="data_validation()"></a>data_validation()</h6><p>下拉选项，如下：</p><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs livescript"><span class="hljs-comment">#仅能输入大于100的数字</span><br>$worksheet-&gt;data_validation(<span class="hljs-string">&#x27;B3&#x27;</span>,<br>    &#123;<br>        validate =&gt; <span class="hljs-string">&#x27;integer&#x27;</span>,<br>        criteria =&gt; <span class="hljs-string">&#x27;&gt;&#x27;</span>,<br>        value    =&gt; <span class="hljs-number">100</span>,<br>    &#125;);<br><br><span class="hljs-comment">#在下拉选项中选择值</span><br>$worksheet-&gt;data_validation(<span class="hljs-string">&#x27;B5:B9&#x27;</span>,<br>    &#123;<br>        validate =&gt; <span class="hljs-string">&#x27;list&#x27;</span>,<br>        value    =&gt; [<span class="hljs-string">&#x27;open&#x27;</span>, <span class="hljs-string">&#x27;high&#x27;</span>, <span class="hljs-string">&#x27;close&#x27;</span>],<br>    &#125;);<br></code></pre></td></tr></table></figure><h6 id="get-name-1"><a href="#get-name-1" class="headerlink" title="get_name()"></a>get_name()</h6><p>获取 sheet 表的名称，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">foreach</span> <span class="hljs-keyword">my</span> $sheet ($workbook-&gt;sheets()) &#123;<br>    <span class="hljs-keyword">print</span> $sheet-&gt;get_name();<br>&#125;<br></code></pre></td></tr></table></figure><h6 id="activate"><a href="#activate" class="headerlink" title="activate()"></a>activate()</h6><p>设置默认展示的 sheet 表，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$worksheet1</span> = <span class="hljs-variable">$workbook</span>-&gt;add_worksheet(<span class="hljs-string">&#x27;To&#x27;</span>);<br><span class="hljs-variable">$worksheet2</span> = <span class="hljs-variable">$workbook</span>-&gt;add_worksheet(<span class="hljs-string">&#x27;the&#x27;</span>);<br><span class="hljs-variable">$worksheet3</span> = <span class="hljs-variable">$workbook</span>-&gt;add_worksheet(<span class="hljs-string">&#x27;wind&#x27;</span>);<br><br><span class="hljs-variable">$worksheet3</span>-&gt;activate(); <span class="hljs-comment">#默认展示wind表</span><br></code></pre></td></tr></table></figure><h6 id="select"><a href="#select" class="headerlink" title="select()"></a>select()</h6><p>选中 sheet 表，如下：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$worksheet1</span>-&gt;activate();</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet2</span>-&gt;select();</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet3</span>-&gt;select();</span><br></code></pre></td></tr></table></figure><h6 id="hide"><a href="#hide" class="headerlink" title="hide()"></a>hide()</h6><p>隐藏 sheet 表，如下：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$worksheet2</span>-&gt;hide();</span><br></code></pre></td></tr></table></figure><h6 id="set-first-sheet"><a href="#set-first-sheet" class="headerlink" title="set_first_sheet()"></a>set_first_sheet()</h6><p>设置为第一个 sheet，如下：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-function"><span class="hljs-title">for</span></span> (<span class="hljs-number">1.</span><span class="hljs-number">.20</span>) &#123;<br>    <span class="hljs-symbol">$</span>workbook-&gt;add_worksheet;<br>&#125;<br><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet21</span> = $workbook-&gt;add_worksheet();</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet22</span> = $workbook-&gt;add_worksheet();</span><br><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet21</span>-&gt;set_first_sheet(); #设置为第一个sheet</span><br><span class="hljs-meta"><span class="hljs-keyword">$worksheet22</span>-&gt;activate();</span><br></code></pre></td></tr></table></figure><h6 id="protect-password"><a href="#protect-password" class="headerlink" title="protect($password)"></a>protect($password)</h6><p>开启保护，密码可选，如下：</p><figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs lasso">$worksheet-&gt;<span class="hljs-keyword">protect</span>();<br><span class="hljs-literal">or</span><br>$worksheet-&gt;<span class="hljs-keyword">protect</span>(<span class="hljs-string">&#x27;drowssap&#x27;</span>);<br></code></pre></td></tr></table></figure><h6 id="set-selection-first-row-first-col-last-row-last-col"><a href="#set-selection-first-row-first-col-last-row-last-col" class="headerlink" title="set_selection($first_row, $first_col, $last_row, $last_col)"></a>set_selection($first_row, $first_col, $last_row, $last_col)</h6><p>选中指定区域，如下：</p><figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs clean">$worksheet1-&gt;set_selection(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>);       # <span class="hljs-number">1.</span> Cell D4.<br>$worksheet2-&gt;set_selection(<span class="hljs-number">3</span>, <span class="hljs-number">3</span>, <span class="hljs-number">6</span>, <span class="hljs-number">6</span>); # <span class="hljs-number">2.</span> Cells D4 to G7.<br>$worksheet3-&gt;set_selection(<span class="hljs-number">6</span>, <span class="hljs-number">6</span>, <span class="hljs-number">3</span>, <span class="hljs-number">3</span>); # <span class="hljs-number">3.</span> Cells G7 to D4.<br>$worksheet4-&gt;set_selection(<span class="hljs-string">&#x27;D4&#x27;</span>);       # Same <span class="hljs-keyword">as</span> <span class="hljs-number">1.</span><br>$worksheet5-&gt;set_selection(<span class="hljs-string">&#x27;D4:G7&#x27;</span>);    # Same <span class="hljs-keyword">as</span> <span class="hljs-number">2.</span><br>$worksheet6-&gt;set_selection(<span class="hljs-string">&#x27;G7:D4&#x27;</span>);    # Same <span class="hljs-keyword">as</span> <span class="hljs-number">3.</span><br></code></pre></td></tr></table></figure><h6 id="set-row-row-height-format-hidden-level-collapsed"><a href="#set-row-row-height-format-hidden-level-collapsed" class="headerlink" title="set_row($row, $height, $format, $hidden, $level, $collapsed)"></a>set_row($row, $height, $format, $hidden, $level, $collapsed)</h6><p>设置行属性，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$worksheet</span>-&gt;set_row(<span class="hljs-number">0</span>, <span class="hljs-number">20</span>); <span class="hljs-comment"># 设置第一行的行高为20</span><br></code></pre></td></tr></table></figure><h6 id="set-column-first-col-last-col-width-format-hidden-level-collapsed"><a href="#set-column-first-col-last-col-width-format-hidden-level-collapsed" class="headerlink" title="set_column($first_col, $last_col, $width, $format, $hidden, $level, $collapsed)"></a>set_column($first_col, $last_col, $width, $format, $hidden, $level, $collapsed)</h6><p>设置列属性，同上</p><h6 id="merge-range-first-row-first-col-last-row-last-col-token-format-utf-16-be"><a href="#merge-range-first-row-first-col-last-row-last-col-token-format-utf-16-be" class="headerlink" title="merge_range($first_row, $first_col, $last_row, $last_col, $token, $format, $utf_16_be)"></a>merge_range($first_row, $first_col, $last_row, $last_col, $token, $format, $utf_16_be)</h6><p>合并单元格，如下：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs arcade">my <span class="hljs-symbol">$format</span> = <span class="hljs-symbol">$wor</span>kbook-&gt;add_format(<br>                                    <span class="hljs-function"><span class="hljs-params">border</span>  =&gt;</span> <span class="hljs-number">6</span>,<br>                                    valign  =&gt; <span class="hljs-string">&#x27;vcenter&#x27;</span>,<br>                                    align   =&gt; <span class="hljs-string">&#x27;center&#x27;</span>,<br>                                  );<br><br><span class="hljs-symbol">$wor</span>ksheet-&gt;merge_range(<span class="hljs-string">&#x27;B3:D4&#x27;</span>, <span class="hljs-string">&#x27;Vertical and horizontal&#x27;</span>, <span class="hljs-symbol">$format</span>);<br></code></pre></td></tr></table></figure><h6 id="set-zoom-scale"><a href="#set-zoom-scale" class="headerlink" title="set_zoom($scale)"></a>set_zoom($scale)</h6><p>设置 zoom 属性</p><h6 id="right-to-left"><a href="#right-to-left" class="headerlink" title="right_to_left()"></a>right_to_left()</h6><p>颠倒 A1 的位置</p><h6 id="hide-zero"><a href="#hide-zero" class="headerlink" title="hide_zero()"></a>hide_zero()</h6><p>隐藏为 0 的值，如下：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$worksheet</span>-&gt;hide_zero();</span><br></code></pre></td></tr></table></figure><h6 id="set-tab-color"><a href="#set-tab-color" class="headerlink" title="set_tab_color()"></a>set_tab_color()</h6><p>设置 sheet Tab 的颜色，如下：</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">worksheet1</span>-&gt;</span>set_tab_color(<span class="hljs-string">&#x27;red&#x27;</span>);<br>$<span class="hljs-function"><span class="hljs-title">worksheet2</span>-&gt;</span>set_tab_color(<span class="hljs-number">0</span>x0C);<br></code></pre></td></tr></table></figure><h6 id="autofilter-first-row-first-col-last-row-last-col"><a href="#autofilter-first-row-first-col-last-row-last-col" class="headerlink" title="autofilter($first_row, $first_col, $last_row, $last_col)"></a>autofilter($first_row, $first_col, $last_row, $last_col)</h6><p>自动筛选，如下：</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>autofilter(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">10</span>, <span class="hljs-number">3</span>);<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>autofilter(<span class="hljs-string">&#x27;A1:D11&#x27;</span>);    # Same <span class="hljs-keyword">as</span> above <span class="hljs-built_in">in</span> A1 notation.<br></code></pre></td></tr></table></figure><h6 id="filter-column-column-expression"><a href="#filter-column-column-expression" class="headerlink" title="filter_column($column, $expression)"></a>filter_column($column, $expression)</h6><p>设置筛选条件，如下：</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>filter_column(<span class="hljs-string">&#x27;A&#x27;</span>, <span class="hljs-string">&#x27;x &gt; 2000&#x27;</span>);<br>$<span class="hljs-function"><span class="hljs-title">worksheet</span>-&gt;</span>filter_column(<span class="hljs-string">&#x27;B&#x27;</span>, <span class="hljs-string">&#x27;x &gt; 2000 and x &lt; 5000&#x27;</span>);<br></code></pre></td></tr></table></figure><p>运算符如下：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-string">运算符</span>         <span class="hljs-string">近义词</span><br>  <span class="hljs-string">==</span>           <span class="hljs-string">=</span>   <span class="hljs-string">eq</span>  <span class="hljs-string">=~</span><br>  <span class="hljs-type">!=</span>           <span class="hljs-string">&lt;&gt;</span>  <span class="hljs-string">ne</span>  <span class="hljs-type">!=</span><br>  <span class="hljs-string">&gt;</span><br><span class="hljs-string">  &lt;</span><br><span class="hljs-string">  &gt;=</span><br><span class="hljs-string">  &lt;=</span><br><span class="hljs-string"></span><br>  <span class="hljs-string">and</span>          <span class="hljs-string">&amp;&amp;</span><br>  <span class="hljs-string">or</span>           <span class="hljs-string">||</span><br></code></pre></td></tr></table></figure><p><code>*</code> 表示一个或多个字符， <code>？</code> 表示一个字符</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs 1c">&#x27;x == Blanks&#x27;     <span class="hljs-meta">#空白</span><br>&#x27;x == NonBlanks&#x27;  <span class="hljs-meta">#不为空白</span><br>&#x27;Top    10 Items&#x27; <span class="hljs-meta">#前10个</span><br>&#x27;Bottom  5 Items&#x27; <span class="hljs-meta">#后5个</span><br>&#x27;Top    25 %&#x27;     <span class="hljs-meta">#前25%</span><br>&#x27;Bottom 50 %&#x27;     <span class="hljs-meta">#后50%</span><br>&#x27;x =~ b*&#x27;         <span class="hljs-meta"># 以b开头</span><br>&#x27;x !~ b*&#x27;         <span class="hljs-meta"># 不以b开头</span><br>&#x27;x =~ *b&#x27;         <span class="hljs-meta"># 以b结尾</span><br>&#x27;x !~ *b&#x27;         <span class="hljs-meta"># 不以b结尾</span><br>&#x27;x =~ *b*&#x27;        <span class="hljs-meta">#  包含b</span><br>&#x27;x !~ *b*&#x27;        <span class="hljs-meta"># 不包含b</span><br></code></pre></td></tr></table></figure><h4 id="format"><a href="#format" class="headerlink" title="format"></a>format</h4><h6 id="set-format-properties-properties"><a href="#set-format-properties-properties" class="headerlink" title="set_format_properties(%properties)"></a>set_format_properties(%properties)</h6><p>设置单元格属性，如下：</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs arcade">my <span class="hljs-symbol">$format</span> = <span class="hljs-symbol">$wor</span>kbook-&gt;add_format();<br><span class="hljs-symbol">$format</span>-&gt;set_format_properties(<span class="hljs-function"><span class="hljs-params">bold</span> =&gt;</span> <span class="hljs-number">1</span>, color =&gt; <span class="hljs-string">&#x27;red&#x27;</span>);<br></code></pre></td></tr></table></figure><h6 id="set-font-fontname"><a href="#set-font-fontname" class="headerlink" title="set_font($fontname)"></a>set_font($fontname)</h6><p>设置字体，默认为 <code>Arial</code> ，如下：</p><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xl">$<span class="hljs-function"><span class="hljs-title">format</span>-&gt;</span>set_font(<span class="hljs-string">&#x27;Times New Roman&#x27;</span>);<br></code></pre></td></tr></table></figure><h6 id="set-size"><a href="#set-size" class="headerlink" title="set_size()"></a>set_size()</h6><p>设置字体大小，默认大小为 <code>10</code> ,如下：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs gams">my <span class="hljs-symbol">$</span>format = <span class="hljs-symbol">$</span>workbook-&gt;add_format();<br><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;set_size(30);</span><br></code></pre></td></tr></table></figure><h6 id="set-color"><a href="#set-color" class="headerlink" title="set_color()"></a>set_color()</h6><p>设置字体颜色，如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta"># <span class="hljs-string">&#x27;black&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;blue&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;brown&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;cyan&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;gray&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;green&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;lime&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;magenta&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;navy&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;orange&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;pink&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;purple&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;red&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;silver&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;white&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;yellow&#x27;</span></span><br><br>my $format = $workbook-&gt;add_format()<span class="hljs-comment">;</span><br>$format-&gt;set_color(<span class="hljs-string">&#x27;red&#x27;</span>)<span class="hljs-comment">;</span><br>$worksheet-&gt;write(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;wheelbarrow&#x27;</span>, $format)<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure><h6 id="set-bold"><a href="#set-bold" class="headerlink" title="set_bold()"></a>set_bold()</h6><p>是否开启加粗。一般情况下可以添加 100-1000 的参数。400 表示正常，700 表示加粗，1000 表示非常粗。但最好是不写，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$format</span>-&gt;set_bold(); <span class="hljs-comment">#加粗</span><br></code></pre></td></tr></table></figure><h6 id="set-italic"><a href="#set-italic" class="headerlink" title="set_italic()"></a>set_italic()</h6><p>设置斜体，如下：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-keyword">$format</span>-&gt;set_italic();</span><br></code></pre></td></tr></table></figure><h6 id="set-underline"><a href="#set-underline" class="headerlink" title="set_underline()"></a>set_underline()</h6><p>设置下划线，如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-variable">$format</span>-&gt;set_underline(<span class="hljs-number">0</span>); <span class="hljs-comment">#取消下划线</span><br><span class="hljs-variable">$format</span>-&gt;set_underline(); <span class="hljs-comment">#设置下划线</span><br><span class="hljs-variable">$format</span>-&gt;set_underline(<span class="hljs-number">1</span>); <span class="hljs-comment">#设置下划线</span><br><span class="hljs-variable">$format</span>-&gt;set_underline(<span class="hljs-number">2</span>); <span class="hljs-comment">#设置双下划线</span><br></code></pre></td></tr></table></figure><h6 id="set-font-strikeout"><a href="#set-font-strikeout" class="headerlink" title="set_font_strikeout()"></a>set_font_strikeout()</h6><p>设置删除线</p><h6 id="set-font-script"><a href="#set-font-script" class="headerlink" title="set_font_script()"></a>set_font_script()</h6><p>设置角标，如下：</p><figure class="highlight basic"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs basic"><span class="hljs-symbol">0 </span>=&gt; 正常<br><span class="hljs-symbol">1 </span>=&gt; 上角标<br><span class="hljs-symbol">2 </span>=&gt; 下角标<br></code></pre></td></tr></table></figure><h6 id="set-num-format"><a href="#set-num-format" class="headerlink" title="set_num_format()"></a>set_num_format()</h6><p>设置数字格式，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><code class="hljs perl">$format01-&gt;set_num_format(<span class="hljs-string">&#x27;0.000&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">0</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">3.1415926</span>, $format01);    <span class="hljs-comment"># 3.142</span><br><br>$format02-&gt;set_num_format(<span class="hljs-string">&#x27;#,##0&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">1</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">1234.56</span>,   $format02);    <span class="hljs-comment"># 1,235</span><br><br>$format03-&gt;set_num_format(<span class="hljs-string">&#x27;#,##0.00&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">2</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">1234.56</span>,   $format03);    <span class="hljs-comment"># 1,234.56</span><br><br>$format04-&gt;set_num_format(<span class="hljs-string">&#x27;$0.00&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">3</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">49.99</span>,     $format04);    <span class="hljs-comment"># $49.99</span><br><br><span class="hljs-comment"># Note you can use other currency symbols such as the pound or yen as well.</span><br><span class="hljs-comment"># Other currencies may require the use of Unicode.</span><br><br>$format07-&gt;set_num_format(<span class="hljs-string">&#x27;mm/dd/yy&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">6</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">36892.521</span>, $format07);    <span class="hljs-comment"># 01/01/01</span><br><br>$format08-&gt;set_num_format(<span class="hljs-string">&#x27;mmm d yyyy&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">7</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">36892.521</span>, $format08);    <span class="hljs-comment"># Jan 1 2001</span><br><br>$format09-&gt;set_num_format(<span class="hljs-string">&#x27;d mmmm yyyy&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">8</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">36892.521</span>, $format09);    <span class="hljs-comment"># 1 January 2001</span><br><br>$format10-&gt;set_num_format(<span class="hljs-string">&#x27;dd/mm/yyyy hh:mm AM/PM&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">9</span>,  <span class="hljs-number">0</span>, <span class="hljs-number">36892.521</span>, $format10);    <span class="hljs-comment"># 01/01/2001 12:30 AM</span><br><br>$format11-&gt;set_num_format(<span class="hljs-string">&#x27;0 &quot;dollar and&quot; .00 &quot;cents&quot;&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-number">1.87</span>,      $format11);    <span class="hljs-comment"># 1 dollar and .87 cents</span><br><br><span class="hljs-comment"># Conditional formatting</span><br>$format12-&gt;set_num_format(<span class="hljs-string">&#x27;[Green]General;[Red]-General;General&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">11</span>, <span class="hljs-number">0</span>, <span class="hljs-number">123</span>,       $format12);    <span class="hljs-comment"># &gt; 0 Green</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">12</span>, <span class="hljs-number">0</span>, -<span class="hljs-number">45</span>,       $format12);    <span class="hljs-comment"># &lt; 0 Red</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">13</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,         $format12);    <span class="hljs-comment"># = 0 Default colour</span><br><br><span class="hljs-comment"># Zip code</span><br>$format13-&gt;set_num_format(<span class="hljs-string">&#x27;00000&#x27;</span>);<br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-number">14</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;01209&#x27;</span>,   $format13);<br></code></pre></td></tr></table></figure><h6 id="set-locked"><a href="#set-locked" class="headerlink" title="set_locked()"></a>set_locked()</h6><p>是否上锁，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $locked  = $workbook-&gt;add_format();<br>$locked-&gt;set_locked(<span class="hljs-number">1</span>); <span class="hljs-comment"># A non-op</span><br><br><span class="hljs-keyword">my</span> $unlocked = $workbook-&gt;add_format();<br>$locked-&gt;set_locked(<span class="hljs-number">0</span>);<br><br><span class="hljs-comment"># Enable worksheet protection</span><br>$worksheet-&gt;protect();<br><br><span class="hljs-comment"># This cell cannot be edited.</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A1&#x27;</span>, <span class="hljs-string">&#x27;=1+2&#x27;</span>, $locked);<br><br><span class="hljs-comment"># This cell can be edited.</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A2&#x27;</span>, <span class="hljs-string">&#x27;=1+2&#x27;</span>, $unlocked);<br></code></pre></td></tr></table></figure><h6 id="set-hidden"><a href="#set-hidden" class="headerlink" title="set_hidden()"></a>set_hidden()</h6><p>是否隐藏，如下：</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs perl"><span class="hljs-keyword">my</span> $hidden = $workbook-&gt;add_format();<br>$hidden-&gt;set_hidden();<br><br><span class="hljs-comment"># Enable worksheet protection</span><br>$worksheet-&gt;protect();<br><br><span class="hljs-comment"># The formula in this cell isn&#x27;t visible</span><br>$worksheet-&gt;<span class="hljs-keyword">write</span>(<span class="hljs-string">&#x27;A1&#x27;</span>, <span class="hljs-string">&#x27;=1+2&#x27;</span>, $hidden);<br></code></pre></td></tr></table></figure><h6 id="set-align"><a href="#set-align" class="headerlink" title="set_align()"></a>set_align()</h6><p>设置对齐方式，如下：</p><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs autoit">Horizontal<br><span class="hljs-meta"># <span class="hljs-string">&#x27;left&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;center&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;right&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;fill&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;justify&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;center_across&#x27;</span></span><br><br>Vertical<br><span class="hljs-meta"># <span class="hljs-string">&#x27;top&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;vcenter&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;bottom&#x27;</span></span><br><span class="hljs-meta"># <span class="hljs-string">&#x27;vjustify&#x27;</span></span><br></code></pre></td></tr></table></figure><h6 id="set-bg-color"><a href="#set-bg-color" class="headerlink" title="set_bg_color()"></a>set_bg_color()</h6><p>设置背景色</p><h6 id="set-fg-color"><a href="#set-fg-color" class="headerlink" title="set_fg_color()"></a>set_fg_color()</h6><p>设置前景色</p><h6 id="set-border"><a href="#set-border" class="headerlink" title="set_border()"></a>set_border()</h6><p>设置边框，如下：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs abnf">Index   Name            Weight   Style<br><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>   <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>   <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span>   <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><br><span class="hljs-number">0</span>       None            <span class="hljs-number">0</span><br><span class="hljs-number">1</span>       Continuous      <span class="hljs-number">1</span>        -----------<br><span class="hljs-number">2</span>       Continuous      <span class="hljs-number">2</span>        -----------<br><span class="hljs-number">3</span>       Dash            <span class="hljs-number">1</span>        - - - - - -<br><span class="hljs-number">4</span>       Dot             <span class="hljs-number">1</span>        . . . . . .<br><span class="hljs-number">5</span>       Continuous      <span class="hljs-number">3</span>        -----------<br><span class="hljs-number">6</span>       Double          <span class="hljs-number">3</span>        <span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><span class="hljs-operator">=</span><br><span class="hljs-number">7</span>       Continuous      <span class="hljs-number">0</span>        -----------<br><span class="hljs-number">8</span>       Dash            <span class="hljs-number">2</span>        - - - - - -<br><span class="hljs-number">9</span>       Dash Dot        <span class="hljs-number">1</span>        - . - . - .<br><span class="hljs-number">10</span>      Dash Dot        <span class="hljs-number">2</span>        - . - . - .<br><span class="hljs-number">11</span>      Dash Dot Dot    <span class="hljs-number">1</span>        - . . - . .<br><span class="hljs-number">12</span>      Dash Dot Dot    <span class="hljs-number">2</span>        - . . - . .<br><span class="hljs-number">13</span>      SlantDash Dot   <span class="hljs-number">2</span>        / - . / - .<br></code></pre></td></tr></table></figure><h6 id="set-border-color"><a href="#set-border-color" class="headerlink" title="set_border_color()"></a>set_border_color()</h6><p>设置边框颜色</p><h6 id="copy-format"><a href="#copy-format" class="headerlink" title="copy($format)"></a>copy($format)</h6><p>格式刷</p><h6 id="更多详情请移步-Spreadsheet-WriteExcel-的官方资料"><a href="#更多详情请移步-Spreadsheet-WriteExcel-的官方资料" class="headerlink" title="更多详情请移步 Spreadsheet::WriteExcel 的官方资料"></a>更多详情请移步 <a target="_blank" rel="noopener" href="https://metacpan.org/pod/Spreadsheet::WriteExcel">Spreadsheet::WriteExcel</a> 的官方资料</h6><hr></div><div><hr><div style="margin-top:20px;text-align:center"><div style="margin-bottom:10px">如果这篇文章对你有帮助，或者想给我微小的工作一点点资瓷，请随意打赏。</div><div id="QR" style="display:block"><div id="wechat" style="display:inline-block;margin-right:50px"><img id="wechat_qr" src="https://pangao1990.gitee.io/images/wechatpay.jpg" srcset="/img/loading.gif" lazyload alt="潘高 微信支付" style="width:150px;height:150px"><p style="color:#159718">微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="https://pangao1990.gitee.io/images/alipay.png" srcset="/img/loading.gif" lazyload alt="潘高 支付宝" style="width:150px;height:150px"><p style="color:#217cfb">支付宝</p></div></div></div><hr><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Perl/" class="category-chain-item">Perl</a> <span>></span> <a href="/categories/Perl/Excel/" class="category-chain-item">Excel</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Perl/">#Perl</a></div></div><div class="license-box my-3"><div class="license-title"><div>perl处理Excel(跨平台)</div><div>https://blog.pangao.vip/perl处理Excel(跨平台)/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>潘高</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2019年3月28日 晚上</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2023年4月25日 下午</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/python-docx%E5%A4%84%E7%90%86word%E6%96%87%E6%A1%A3/" title="python-docx处理word文档"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">python-docx处理word文档</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/IT%E5%9C%A8%E7%BA%BF%E8%AF%BE%E5%A0%82%E6%9C%89%E5%93%AA%E4%BA%9B/" title="IT在线课堂有哪些"><span class="hidden-mobile">IT在线课堂有哪些</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5317369003185250" data-ad-slot="9014150860" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><br><hr><br><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",function(){Fluid.utils.createCssLink("https://cdn.staticfile.org/waline/2.14.1/waline.min.css"),Fluid.utils.createScript("https://cdn.staticfile.org/waline/2.14.1/waline.min.js",function(){var i=Object.assign({serverURL:"https://comment.pangao.vip",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://unpkg.com/@waline/emojis@1.1.0/qq","https://unpkg.com/@waline/emojis@1.1.0/weibo"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10,avatar:"identicon",avatarCDN:"https://seccdn.libravatar.org/avatar/",avatarForce:!1,highlight:!0},{el:"#waline",path:window.location.pathname});Waline.init(i),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var i="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>评论功能在允许 JavaScript 运行的环境下效果更佳哦</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div class="col-lg-7 mx-auto nopadding-x-md"><div class="container custom mx-auto"><link rel="stylesheet" href="//at.alicdn.com/t/font_1765130_cg2uvt55y8.css"></div></div></main><footer><div class="footer-inner"><p id="hitokoto" style="color:#8a2be2">即将出现一段不可描述的话...</p><script>fetch("https://v1.hitokoto.cn").then(t=>t.json()).then(t=>{document.getElementById("hitokoto").innerText=t.hitokoto}).catch(console.error)</script><div><span id="timeDate">正在烧脑计算建站时间...</span> <span id="times"></span><script>var now=new Date;function createtime(){var n=new Date("02/23/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已默默无闻运行&nbsp"+dnum+"&nbsp天",document.getElementById("times").innerHTML=hnum+"&nbsp小时&nbsp"+mnum+"&nbsp分&nbsp"+snum+"&nbsp秒"}setInterval("createtime()",250)</script></div><div class="statistics"><span id="leancloud-site-uv-container" style="display:none">承蒙 <span id="leancloud-site-uv"></span> 位朋友 </span><span id="leancloud-site-pv-container" style="display:none">造访 <span id="leancloud-site-pv"></span> 次</span></div><div class="beian"><span><a href="/icp/blog.pangao.vip.html" target="_blank" rel="nofollow noopener">猿ICP证19901222号</a></span></div><span id="cnzz_stat_icon_1278827075" style="display:none"></span></div></footer><script src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://cdn.staticfile.org/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://cdn.staticfile.org/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://cdn.staticfile.org/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳哦</div></noscript></body></html>