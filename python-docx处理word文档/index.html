<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="https://pangao1990.gitee.io/images/favicon.jpg"><link rel="icon" href="https://pangao1990.gitee.io/images/favicon.jpg"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="潘高"><meta name="keywords" content="Python,python-docx,word,文档,跨平台,linux,mac,pc,win"><meta name="description" content="使用python-docx模块实现跨平台处理Word文档，可以在mac、linux、pc上运行。"><meta property="og:type" content="article"><meta property="og:title" content="python-docx处理word文档"><meta property="og:url" content="https://blog.pangao.vip/python-docx%E5%A4%84%E7%90%86word%E6%96%87%E6%A1%A3/"><meta property="og:site_name" content="潘高的小站"><meta property="og:description" content="使用python-docx模块实现跨平台处理Word文档，可以在mac、linux、pc上运行。"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2019-04-03T09:51:22.000Z"><meta property="article:modified_time" content="2021-07-29T06:05:00.648Z"><meta property="article:author" content="潘高"><meta property="article:tag" content="Python"><meta name="twitter:card" content="summary_large_image"><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5317369003185250" crossorigin="anonymous"></script><meta name="google-site-verification" content="google180fd90b1a12c24d.html"><title>python-docx处理word文档 - 潘高的小站</title><link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var dntVal,Fluid=window.Fluid||{},CONFIG=(Fluid.ctx=Object.assign({},Fluid.ctx),{hostname:"blog.pangao.vip",root:"/",version:"1.9.4",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!1},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!0,follow_dnt:!0,baidu:"3cb997f9d46af905b450452a8f181d9e",google:"UA-163962674-1",gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:1278827075,leancloud:{app_id:"w5RAfQXjT6iFfBtGwiTfxQOP-gzGzoHsz",app_key:"h55viQ2cLIrigHjPHDfIS2ly",server_url:"https://w5rafqxj.lc-cn-n1-shared.com",path:"window.location.pathname",ignore_local:!0}},search_path:"/local-search.xml"});CONFIG.web_analytics.follow_dnt&&(dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on")))</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><script async>var _hmt;Fluid.ctx.dnt||(_hmt=_hmt||[],function(){var t=document.createElement("script"),e=(t.src="https://hm.baidu.com/hm.js?3cb997f9d46af905b450452a8f181d9e",document.getElementsByTagName("script")[0]);e.parentNode.insertBefore(t,e)}())</script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("https://www.google-analytics.com/analytics.js",function(){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-163962674-1","auto"),ga("send","pageview")})</script><script async src="https://www.google-analytics.com/analytics.js"></script><script async>Fluid.ctx.dnt||Fluid.utils.createScript("//s4.cnzz.com/z_stat.php?id=1278827075&show=pic")</script><meta name="generator" content="Hexo 6.3.0"></head><script async src="https://www.googletagmanager.com/gtag/js?id=AW-715652541"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","AW-715652541")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-P4XN0EX1GY"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-P4XN0EX1GY")</script><body><header><div class="header-inner" style="height:40vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>潘高的小站</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/tags/"><i class="iconfont icon-tags-fill"></i> <span>标签</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/"><i class="iconfont icon-shijianzhou"></i> <span>时间轴</span></a></li><li class="nav-item"><a class="nav-link" href="/about/"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item"><a class="nav-link" href="/icp/"><i class="iconfont icon-icp"></i> <span>icp备案</span></a></li><li class="nav-item"><a class="nav-link" href="/links/"><i class="iconfont icon-link-fill"></i> <span>友链</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.2)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="python-docx处理word文档"></span></div><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> 潘高 </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2019-04-03 17:51" pubdate>星期三, 四月 3日 2019, 5:51 下午</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 5.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 27 分钟 </span><span id="leancloud-page-views-container" class="post-meta" style="display:none"><i class="iconfont icon-eye" aria-hidden="true"></i> <span id="leancloud-page-views"></span> 次</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-1"></div><div class="col-lg-9 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 style="display:none">python-docx处理word文档</h1><p class="note note-info">本文最后更新于：2021年7月29日 下午</p><div class="markdown-body"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>全网找了一番，用python创建和更新word(.docx)文档，还是 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/">python-docx</a> 包比较好用。</p><h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><ul><li>Python 2.6, 2.7, 3.3, or 3.4</li><li>lxml &gt;&#x3D; 2.3.2</li></ul><span id="more"></span><h2 id="安装模块"><a href="#安装模块" class="headerlink" title="安装模块"></a>安装模块</h2><ul><li>由于 <code>python-docx</code> 已经提交给 <a target="_blank" rel="noopener" href="https://pypi.org/">PyPI</a> 仓库，所以可以使用 <code>pip</code> 安装，如下：<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">pip <span class="hljs-keyword">install</span> python-docx<br></code></pre></td></tr></table></figure>如果同时安装了 <code>python2</code> 和 <code>python3</code> 那么 <code>pip</code> 可能不能用，可以使用 <code>pip3</code> 来安装，如下：<figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs cmake">pip3 <span class="hljs-keyword">install</span> python-docx<br></code></pre></td></tr></table></figure></li><li><code>python-docx</code> 也可以使用 <code>easy_install</code> 来安装，如下：<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">easy_install python-docx</span><br></code></pre></td></tr></table></figure></li><li>如果不能使用 <code>pip</code> 和 <code>easy_install</code> ，可以在 <code>PyPI</code> 下载包、解压、运行 <code>setup.py</code> ，如下：<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs vim">tar xvzf <span class="hljs-keyword">python</span>-docx-&#123;<span class="hljs-keyword">version</span>&#125;.tar.gz<br><span class="hljs-keyword">cd</span> <span class="hljs-keyword">python</span>-docx-&#123;<span class="hljs-keyword">version</span>&#125;<br><span class="hljs-keyword">python</span> setup.<span class="hljs-keyword">py</span> install<br></code></pre></td></tr></table></figure><code>python-docx</code> 还依赖 <code>lxml</code> 包 ，使用前2种方法会自动安装所需依赖包，第三种方法需要自己手动安装。</li></ul><h2 id="处理word文档"><a href="#处理word文档" class="headerlink" title="处理word文档"></a>处理word文档</h2><h4 id="新建文档类"><a href="#新建文档类" class="headerlink" title="新建文档类"></a>新建文档类</h4><p>首先新建一个空白文档类 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/document.html">Document</a> ，如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> <span class="hljs-title class_">Document</span><br><br><span class="hljs-variable language_">document</span> = <span class="hljs-title class_">Document</span>()<br></code></pre></td></tr></table></figure><h4 id="编辑已存在的word文档"><a href="#编辑已存在的word文档" class="headerlink" title="编辑已存在的word文档"></a>编辑已存在的word文档</h4><p><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/">python-docx</a> 不仅可以创建word文档，还可以编辑已存在的word文档。<br>其实吧，这玩意儿只能编辑已存在的word文档，之所以有个“创建空白文档”的功能，只不过是拷贝一份空白word文档到工作区间，再在空白文档上编辑，看起来似乎是“创建空白文档”罢了。本质上还是编辑已存在的word文档，捂脸中…<br>打开一个word文档，编辑完后，一定要记得保存。如果保存文件名和原文件名不一样，则会另存为一份word文档；若文件名一样，则会不加提示的保存修改内容。如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-keyword">from</span> docx <span class="hljs-keyword">import</span> <span class="hljs-title class_">Document</span><br><br><span class="hljs-variable language_">document</span> = <span class="hljs-title class_">Document</span>(<span class="hljs-string">&#x27;existing-document-file.docx&#x27;</span>)<br><span class="hljs-variable language_">document</span>.<span class="hljs-title function_">save</span>(<span class="hljs-string">&#x27;new-file-name.docx&#x27;</span>)<br></code></pre></td></tr></table></figure><h4 id="新增段落"><a href="#新增段落" class="headerlink" title="新增段落"></a>新增段落</h4><p>在word中 <code>段落</code> 是最常见的，创建段落 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/text.html">paragraph</a> 的操作如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">paragraph</span> = document.add_paragraph(<span class="hljs-string">&#x27;这是个段落。&#x27;</span>)<br></code></pre></td></tr></table></figure><p>在此段落之前插入一个段落，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">prior_paragraph</span> = paragraph.insert_paragraph_before(<span class="hljs-string">&#x27;这是前面的段落。&#x27;</span>)<br></code></pre></td></tr></table></figure><h4 id="新增标题"><a href="#新增标题" class="headerlink" title="新增标题"></a>新增标题</h4><p>新增标题代码如下：</p><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs dart"><span class="hljs-built_in">document</span>.add_heading(<span class="hljs-string">&#x27;这是个标题&#x27;</span>)<br></code></pre></td></tr></table></figure><p>修改标题大小，有1-9种规格，如下：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">document.add<span class="hljs-constructor">_heading(&#x27;The <span class="hljs-params">role</span> <span class="hljs-params">of</span> <span class="hljs-params">dolphins</span>&#x27;, <span class="hljs-params">level</span>=2)</span><br></code></pre></td></tr></table></figure><p>如果使用 <code>level=0</code> ，则会新增一个带有下划线样式的标题。</p><h4 id="新增分页符"><a href="#新增分页符" class="headerlink" title="新增分页符"></a>新增分页符</h4><p>代码如下：</p><figure class="highlight ceylon"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ceylon">document.add<span class="hljs-number">_p</span>age<span class="hljs-number">_</span><span class="hljs-keyword">break</span>()<br></code></pre></td></tr></table></figure><h4 id="新增表格"><a href="#新增表格" class="headerlink" title="新增表格"></a>新增表格</h4><p>创建一个2行2列的表格 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/table.html">Table</a>，如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">table = document.add_table(<span class="hljs-attribute">rows</span>=2, <span class="hljs-attribute">cols</span>=2)<br></code></pre></td></tr></table></figure><p>获取第一行第二列的单元格类，如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">cell</span> = table.cell(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)<br></code></pre></td></tr></table></figure><p>写入数据，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">cell.text</span> = <span class="hljs-string">&#x27;这是第一行第二列的单元格&#x27;</span><br></code></pre></td></tr></table></figure><p>不仅如此，还能以数组的形式获取整个行或列，如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stylus">row = <span class="hljs-selector-tag">table</span><span class="hljs-selector-class">.rows</span><span class="hljs-selector-attr">[1]</span><br>row<span class="hljs-selector-class">.cells</span><span class="hljs-selector-attr">[0]</span><span class="hljs-selector-class">.text</span> = <span class="hljs-string">&#x27;第二行第一列&#x27;</span><br>row<span class="hljs-selector-class">.cells</span><span class="hljs-selector-attr">[1]</span><span class="hljs-selector-class">.text</span> = <span class="hljs-string">&#x27;第二行第二列&#x27;</span><br></code></pre></td></tr></table></figure><p>或循环操作，如下：</p><figure class="highlight stan"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs stan"><span class="hljs-keyword">for</span> <span class="hljs-built_in">row</span> <span class="hljs-keyword">in</span> table.<span class="hljs-built_in">rows</span>:<br>    <span class="hljs-keyword">for</span> cell <span class="hljs-keyword">in</span> <span class="hljs-built_in">row</span>.cells:<br>        <span class="hljs-built_in">print</span>(cell.text)<br></code></pre></td></tr></table></figure><p>用 <code>len()</code> 方法获取行数或列数，如下：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-built_in">row_count</span> = len(<span class="hljs-keyword">table</span>.<span class="hljs-keyword">rows</span>)<br>col_count = len(<span class="hljs-keyword">table</span>.<span class="hljs-keyword">columns</span>)<br></code></pre></td></tr></table></figure><p>增加行，如下：</p><figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs abnf"><span class="hljs-attribute">row</span> <span class="hljs-operator">=</span> table.add_row()<br></code></pre></td></tr></table></figure><p>设置表格样式，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">table.style</span> = <span class="hljs-string">&#x27;LightShading-Accent1&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="插入图片"><a href="#插入图片" class="headerlink" title="插入图片"></a>插入图片</h4><p>插入本地图片，如下：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">document.add<span class="hljs-constructor">_picture(&#x27;<span class="hljs-params">demo</span>.<span class="hljs-params">png</span>&#x27;)</span><br></code></pre></td></tr></table></figure><p>默认情况下，图片大小往往不尽如人意，调整图片大小，如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-keyword">from</span> docx.shared import Inches<br><br>document.add_picture(<span class="hljs-string">&#x27;demo.png&#x27;</span>, <span class="hljs-attribute">width</span>=Inches(1.0), <span class="hljs-attribute">height</span>=Inches(1.0))<br></code></pre></td></tr></table></figure><p>若同时定义宽度和高度，则图片会被拉伸或压缩到指定大小；若仅定义宽度或高度，则图会自适应调整大小。所以，建议仅定义宽度即可。</p><h4 id="段落操作"><a href="#段落操作" class="headerlink" title="段落操作"></a>段落操作</h4><h5 id="设置段落样式"><a href="#设置段落样式" class="headerlink" title="设置段落样式"></a>设置段落样式</h5><p>设置段落样式，如下：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">document.add_paragraph(<span class="hljs-string">&#x27;这是一个样式为 ListBullet 的段落&#x27;</span>, <span class="hljs-attribute">style</span>=<span class="hljs-string">&#x27;ListBullet&#x27;</span>)<br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">paragraph</span> = document.add_paragraph(<span class="hljs-string">&#x27;这是一个样式为 ListBullet 的段落&#x27;</span>)<br><span class="hljs-attr">paragraph.style</span> = <span class="hljs-string">&#x27;List Bullet&#x27;</span><br></code></pre></td></tr></table></figure><h5 id="设置段落对齐方式"><a href="#设置段落对齐方式" class="headerlink" title="设置段落对齐方式"></a>设置段落对齐方式</h5><p>段落对齐方式有 <code>左对齐</code> 、 <code>文字居中</code> 、 <code>右对齐</code> 、 <code>文本两端对齐</code>等，更多对齐方式请移步 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdAlignParagraph.html#wdparagraphalignment">WD_ALIGN_PARAGRAPH</a></p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">from</span> docx.enum.<span class="hljs-built_in">text</span> import WD_ALIGN_PARAGRAPH<br><br><span class="hljs-comment"># LEFT      =&gt;  左对齐</span><br><span class="hljs-comment"># CENTER    =&gt;  文字居中</span><br><span class="hljs-comment"># RIGHT     =&gt;  右对齐</span><br><span class="hljs-comment"># JUSTIFY   =&gt;  文本两端对齐</span><br><br><span class="hljs-built_in">paragraph</span> = document.add_paragraph(<span class="hljs-string">&quot;你说啥&quot;</span>)<br>paragraph_format = <span class="hljs-built_in">paragraph</span>.paragraph_format<br>paragraph_format.alignment = WD_ALIGN_PARAGRAPH.CENTER<br></code></pre></td></tr></table></figure><h5 id="设置段落缩进"><a href="#设置段落缩进" class="headerlink" title="设置段落缩进"></a>设置段落缩进</h5><p>设置段落缩进，可为负值，如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs stylus">from docx<span class="hljs-selector-class">.shared</span> import Inches<br><br>paragraph = document<span class="hljs-selector-class">.add_paragraph</span>(<span class="hljs-string">&quot;你说啥&quot;</span>)<br>paragraph_format = paragraph<span class="hljs-selector-class">.paragraph_format</span><br>paragraph_format<span class="hljs-selector-class">.left_indent</span> = <span class="hljs-built_in">Inches</span>(<span class="hljs-number">0.5</span>)<br></code></pre></td></tr></table></figure><p>也可以设置首行缩进，如下：</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">paragraph_format</span>.first_line_indent = Inches(-<span class="hljs-number">0</span>.<span class="hljs-number">25</span>)<br></code></pre></td></tr></table></figure><h5 id="设置段落制表符"><a href="#设置段落制表符" class="headerlink" title="设置段落制表符"></a>设置段落制表符</h5><p>详情请移步 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/text.html#docx.text.tabstops.TabStops">TabStops</a></p><h5 id="设置段落间距"><a href="#设置段落间距" class="headerlink" title="设置段落间距"></a>设置段落间距</h5><p>分为 <code>段前</code> 和 <code>段后</code> ，设置值用 <code>Pt</code> 单位是 <code>磅</code> ，如下：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">paragraph_format.space_before</span> = Pt(<span class="hljs-number">18</span>)<br><span class="hljs-attr">paragraph_format.space_after</span> = Pt(<span class="hljs-number">12</span>)<br></code></pre></td></tr></table></figure><h5 id="设置段落行距"><a href="#设置段落行距" class="headerlink" title="设置段落行距"></a>设置段落行距</h5><p>当行距为 <code>最小值</code> 和 <code>固定值</code> 时，设置值单位为 <code>磅</code> ，需要用 <code>Pt</code> ；当行距为 <code>多倍行距</code> 时，设置值为数值，如下：</p><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs applescript"><span class="hljs-keyword">from</span> docx.shared import Length<br><br><span class="hljs-comment">#SINGLE         =&gt;  单倍行距（默认）</span><br><span class="hljs-comment">#ONE_POINT_FIVE =&gt;  1.5倍行距</span><br><span class="hljs-comment">#DOUBLE2        =&gt;  倍行距</span><br><span class="hljs-comment">#AT_LEAST       =&gt;  最小值</span><br><span class="hljs-comment">#EXACTLY        =&gt;  固定值</span><br><span class="hljs-comment">#MULTIPLE       =&gt;  多倍行距</span><br><br><span class="hljs-built_in">paragraph</span>.line_spacing_rule = WD_LINE_SPACING.EXACTLY <span class="hljs-comment">#固定值</span><br>paragraph_format.line_spacing = Pt(<span class="hljs-number">18</span>) <span class="hljs-comment"># 固定值18磅</span><br><span class="hljs-built_in">paragraph</span>.line_spacing_rule = WD_LINE_SPACING.MULTIPLE <span class="hljs-comment">#多倍行距</span><br>paragraph_format.line_spacing = <span class="hljs-number">1.75</span> <span class="hljs-comment"># 1.75倍行间距</span><br></code></pre></td></tr></table></figure><h5 id="设置段落分页"><a href="#设置段落分页" class="headerlink" title="设置段落分页"></a>设置段落分页</h5><ul><li>孤行控制<br>防止在页面顶端单独打印段落末行或在页面底端单独打印段落首行。</li><li>与下段同页<br>防止在选中段落与后面一段间插入分页符。</li><li>段中不分页<br>防止在段落中出现分页符。</li><li>段前分页<br>在选中段落前插入分页符。<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-comment">#widow_control      =&gt;  孤行控制</span><br><span class="hljs-comment">#keep_with_next     =&gt;  与下段同页</span><br><span class="hljs-comment">#page_break_before  =&gt;  段前分页</span><br><span class="hljs-comment">#keep_together      =&gt;  段中不分页</span><br><br><span class="hljs-attr">paragraph_format.keep_with_next</span> = <span class="hljs-literal">True</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="字体操作"><a href="#字体操作" class="headerlink" title="字体操作"></a>字体操作</h4><h5 id="设置粗体和斜体"><a href="#设置粗体和斜体" class="headerlink" title="设置粗体和斜体"></a>设置粗体和斜体</h5><p>在设置粗体和斜体之前，我们先简单了解一下 <code>段落</code> 里的运行机制。段落包含很多块级的格式，比如缩进、行高、制表符等。每一个小片段叫做一个 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/text.html#docx.text.run.Run">run</a> ，可以对 <code>run</code> 设置粗体和斜体等属性。<br>我们可以设置如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs stylus">paragraph = document<span class="hljs-selector-class">.add_paragraph</span>()<br>paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;这是一个带有&#x27;</span>)<br>paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;粗体&#x27;</span>)<span class="hljs-selector-class">.bold</span> = True<br>paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;和&#x27;</span>)<br>paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;斜体&#x27;</span>)<span class="hljs-selector-class">.italic</span> = True<br>paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;的段落。&#x27;</span>)<br></code></pre></td></tr></table></figure><h5 id="设置字体属性"><a href="#设置字体属性" class="headerlink" title="设置字体属性"></a>设置字体属性</h5><p>对 <code>run</code> 设置字体、大小、颜色下划线等，更多属性请移步 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/text.html#docx.text.run.Font">Font</a> ，如下：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">from</span> docx.shared import RGBColor,Pt<br><br><span class="hljs-comment">#all_caps       =&gt;  全部大写字母</span><br><span class="hljs-comment">#bold           =&gt;  加粗</span><br><span class="hljs-comment">#color          =&gt;  字体颜色</span><br><span class="hljs-comment">#complex_script =&gt;  是否为“复杂代码”</span><br><span class="hljs-comment">#cs_bold        =&gt;  “复杂代码”加粗</span><br><span class="hljs-comment">#cs_italic      =&gt;  “复杂代码”斜体</span><br><span class="hljs-comment">#double_strike  =&gt;  双删除线</span><br><span class="hljs-comment">#emboss         =&gt;  文本以凸出页面的方式出现</span><br><span class="hljs-comment">#hidden         =&gt;  隐藏</span><br><span class="hljs-comment">#imprint        =&gt;  印记</span><br><span class="hljs-comment">#italic         =&gt;  斜体</span><br><span class="hljs-comment">#name           =&gt;  字体</span><br><span class="hljs-comment">#no_proof       =&gt;  不验证语法错误</span><br><span class="hljs-comment">#outline        =&gt;  显示字符的轮廓</span><br><span class="hljs-comment">#shadow         =&gt;  阴影</span><br><span class="hljs-comment">#small_caps     =&gt;  小型大写字母</span><br><span class="hljs-comment">#snap_to_grid   =&gt;  定义文档网格时对齐网络</span><br><span class="hljs-comment">#strike         =&gt;  删除线</span><br><span class="hljs-comment">#subscript      =&gt;  下标</span><br><span class="hljs-comment">#superscript    =&gt;  上标</span><br><span class="hljs-comment">#underline      =&gt;  下划线</span><br><br><span class="hljs-keyword">paragraph</span> = document.add_paragraph()<br><span class="hljs-keyword">paragraph</span>.add_run(<span class="hljs-string">&#x27;这是一个带有&#x27;</span>)<br><span class="hljs-keyword">paragraph</span>.add_run(<span class="hljs-string">&#x27;颜色&#x27;</span>).font.color.rgb = RGBColor(<span class="hljs-number">54</span>, <span class="hljs-number">95</span>, <span class="hljs-number">145</span>)<br><span class="hljs-keyword">paragraph</span>.add_run(<span class="hljs-string">&#x27;的&#x27;</span>)<br><span class="hljs-keyword">paragraph</span>.add_run(<span class="hljs-string">&#x27;大字&#x27;</span>).font.size = Pt(<span class="hljs-number">36</span>)  <span class="hljs-comment"># 字体大小设置，和word里面的字号相对应</span><br></code></pre></td></tr></table></figure><h4 id="设置字符样式"><a href="#设置字符样式" class="headerlink" title="设置字符样式"></a>设置字符样式</h4><p>除了设置段落样式外，还可以设置一组字符样式，比如字体、大小、颜色、粗体、斜体等，如下：</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-comment"># 自定义样式 Emphasis</span><br><br><span class="hljs-keyword">paragraph</span> = document.add_paragraph(<span class="hljs-string">&#x27;这是一个带有&#x27;</span>)<br><span class="hljs-keyword">paragraph</span>.add_run(<span class="hljs-string">&#x27;自定义样式&#x27;</span>, <span class="hljs-string">&#x27;Emphasis&#x27;</span>)<br><span class="hljs-keyword">paragraph</span>.add_run(<span class="hljs-string">&#x27;的段落&#x27;</span>)<br></code></pre></td></tr></table></figure><p>或</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs stylus">paragraph = document<span class="hljs-selector-class">.add_paragraph</span>(<span class="hljs-string">&#x27;这是一个带有 &#x27;</span>)<br>run = paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;自定义样式&#x27;</span>)<br>run<span class="hljs-selector-class">.style</span> = <span class="hljs-string">&#x27;Emphasis&#x27;</span><br>paragraph<span class="hljs-selector-class">.add_run</span>(<span class="hljs-string">&#x27;的段落&#x27;</span>)<br></code></pre></td></tr></table></figure><h4 id="页眉和页脚"><a href="#页眉和页脚" class="headerlink" title="页眉和页脚"></a>页眉和页脚</h4><p>更多内容请移步 <a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/user/hdrftr.html">Working with Headers and Footers</a></p><h4 id="枚举的文档"><a href="#枚举的文档" class="headerlink" title="枚举的文档"></a>枚举的文档</h4><ul><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/MsoColorType.html">MSO_COLOR_TYPE</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/MsoThemeColorIndex.html">MSO_THEME_COLOR_INDEX</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdAlignParagraph.html">WD_PARAGRAPH_ALIGNMENT</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdBuiltinStyle.html">WD_BUILTIN_STYLE</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdCellVerticalAlignment.html">WD_CELL_VERTICAL_ALIGNMENT</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdColorIndex.html">WD_COLOR_INDEX</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdLineSpacing.html">WD_LINE_SPACING</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdOrientation.html">WD_ORIENTATION</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdRowAlignment.html">WD_TABLE_ALIGNMENT</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdRowHeightRule.html">WD_ROW_HEIGHT_RULE</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdSectionStart.html">WD_SECTION_START</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdStyleType.html">WD_STYLE_TYPE</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdTabAlignment.html">WD_TAB_ALIGNMENT</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdTabLeader.html">WD_TAB_LEADER</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdTableDirection.html">WD_TABLE_DIRECTION</a></li><li><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/api/enum/WdUnderline.html">WD_UNDERLINE</a></li></ul><h4 id="名称解释"><a href="#名称解释" class="headerlink" title="名称解释"></a>名称解释</h4><p><a target="_blank" rel="noopener" href="https://python-docx.readthedocs.io/en/latest/dev/analysis/index.html">官网解释</a></p><hr></div><div><hr><div style="margin-top:20px;text-align:center"><div style="margin-bottom:10px">如果这篇文章对你有帮助，或者想给我微小的工作一点点资瓷，请随意打赏。</div><div id="QR" style="display:block"><div id="wechat" style="display:inline-block;margin-right:50px"><img id="wechat_qr" src="https://pangao1990.gitee.io/images/wechatpay.jpg" srcset="/img/loading.gif" lazyload alt="潘高 微信支付" style="width:150px;height:150px"><p style="color:#159718">微信支付</p></div><div id="alipay" style="display:inline-block"><img id="alipay_qr" src="https://pangao1990.gitee.io/images/alipay.png" srcset="/img/loading.gif" lazyload alt="潘高 支付宝" style="width:150px;height:150px"><p style="color:#217cfb">支付宝</p></div></div></div><hr><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/Python/" class="category-chain-item">Python</a> <span>></span> <a href="/categories/Python/Word/" class="category-chain-item">Word</a></span></span></div><div class="post-meta"><i class="iconfont icon-tags"></i> <a href="/tags/Python/">#Python</a></div></div><div class="license-box my-3"><div class="license-title"><div>python-docx处理word文档</div><div>https://blog.pangao.vip/python-docx处理word文档/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>潘高</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2019年4月3日 下午</div></div><div class="license-meta-item license-meta-date"><div>更新于</div><div>2021年7月29日 下午</div></div><div class="license-meta-item"><div>许可协议</div><div><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-by"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="NC - 非商业性使用"><i class="iconfont icon-nc"></i> </span></a><a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><span class="hint--top hint--rounded" aria-label="SA - 相同方式共享"><i class="iconfont icon-sa"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/%E8%A7%A3%E5%86%B3MacOS%E7%B3%BB%E7%BB%9F%E5%8D%87%E7%BA%A7%E6%97%B6%E6%98%BE%E7%A4%BA%E5%AE%89%E8%A3%85%E6%89%80%E9%80%89%E6%9B%B4%E6%96%B0%E6%97%B6%E5%8F%91%E7%94%9F%E9%94%99%E8%AF%AF%E7%9A%84%E9%97%AE%E9%A2%98/" title="解决MacOS系统升级时显示安装所选更新时发生错误的问题"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">解决MacOS系统升级时显示安装所选更新时发生错误的问题</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/perl%E5%A4%84%E7%90%86Excel(%E8%B7%A8%E5%B9%B3%E5%8F%B0)/" title="perl处理Excel(跨平台)"><span class="hidden-mobile">perl处理Excel(跨平台)</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div><article id="comments" lazyload><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-5317369003185250" data-ad-slot="9014150860" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle=window.adsbygoogle||[]).push({})</script><br><hr><br><div id="waline"></div><script type="text/javascript">Fluid.utils.loadComments("#waline",function(){Fluid.utils.createCssLink("https://cdn.staticfile.org/waline/2.14.1/waline.min.css"),Fluid.utils.createScript("https://cdn.staticfile.org/waline/2.14.1/waline.min.js",function(){var i=Object.assign({serverURL:"https://waline-1-p3250934.deta.app",path:"window.location.pathname",meta:["nick","mail","link"],requiredMeta:["nick"],lang:"zh-CN",emoji:["https://unpkg.com/@waline/emojis@1.1.0/qq","https://unpkg.com/@waline/emojis@1.1.0/weibo"],dark:'html[data-user-color-scheme="dark"]',wordLimit:0,pageSize:10,avatar:"identicon",avatarCDN:"https://seccdn.libravatar.org/avatar/",avatarForce:!1,highlight:!0},{el:"#waline",path:window.location.pathname});Waline.init(i),Fluid.utils.waitElementVisible("#waline .vcontent",()=>{var i="#waline .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(i),Fluid.plugins.fancyBox(i)})})})</script><noscript>评论功能在允许 JavaScript 运行的环境下效果更佳哦</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div><div class="col-lg-7 mx-auto nopadding-x-md"><div class="container custom mx-auto"><link rel="stylesheet" href="//at.alicdn.com/t/font_1765130_cg2uvt55y8.css"></div></div></main><footer><div class="footer-inner"><p id="hitokoto" style="color:#8a2be2">即将出现一段不可描述的话...</p><script>fetch("https://v1.hitokoto.cn").then(t=>t.json()).then(t=>{document.getElementById("hitokoto").innerText=t.hitokoto}).catch(console.error)</script><div><span id="timeDate">正在烧脑计算建站时间...</span> <span id="times"></span><script>var now=new Date;function createtime(){var n=new Date("02/23/2019 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已默默无闻运行&nbsp"+dnum+"&nbsp天",document.getElementById("times").innerHTML=hnum+"&nbsp小时&nbsp"+mnum+"&nbsp分&nbsp"+snum+"&nbsp秒"}setInterval("createtime()",250)</script></div><div class="statistics"><span id="leancloud-site-uv-container" style="display:none">承蒙 <span id="leancloud-site-uv"></span> 位朋友 </span><span id="leancloud-site-pv-container" style="display:none">造访 <span id="leancloud-site-pv"></span> 次</span></div><div class="beian"><span><a href="/icp/blog.pangao.vip.html" target="_blank" rel="nofollow noopener">猿ICP证19901222号</a></span></div><span id="cnzz_stat_icon_1278827075" style="display:none"></span></div></footer><script src="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://cdn.staticfile.org/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",function(){NProgress.done()})</script><script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script><script src="https://cdn.staticfile.org/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script><script>!function(t){var e=Fluid.plugins.typing,t=t.getElementById("subtitle");t&&e&&e(t.getAttribute("data-typed-text"))}((window,document))</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://cdn.staticfile.org/tocbot/4.18.2/tocbot.min.js",function(){var t,o=jQuery("#toc");0!==o.length&&window.tocbot&&(t=jQuery("#board-ctn").offset().top,window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-t},CONFIG.toc)),0<o.find(".toc-list-item").length&&o.css("visibility","visible"),Fluid.events.registerRefreshCallback(function(){var t;"tocbot"in window&&(tocbot.refresh(),0!==(t=jQuery("#toc")).length)&&tocbot&&0<t.find(".toc-list-item").length&&t.css("visibility","visible")}))})</script><script src="https://cdn.staticfile.org/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://cdn.staticfile.org/anchor-js/4.3.1/anchor.min.js",function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback(function(){if("anchors"in window){anchors.removeAll();var n,o=[];for(n of(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","))o.push(".markdown-body > "+n.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}})})</script><script>Fluid.utils.createScript("https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js",function(){Fluid.plugins.fancyBox()})</script><script defer src="/js/leancloud.js"></script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳哦</div></noscript></body></html>